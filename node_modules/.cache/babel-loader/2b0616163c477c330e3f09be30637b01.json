{"ast":null,"code":"import _slicedToArray from\"/Users/julianneagresta/Projects/openlibrary-search-histogram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// quaternion algebra\n// useState will be used to handle to slow search by returning a pair representing the current state and then a function to update the state respectively\nimport React,{useState}from'react';import'./App.css';import{AgChartsReact}from'ag-charts-react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){//store data from search terms using useState where searchTerm is set to empty string. The setSearchTerm is updated with the input\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1];//store data from API where books is set to an empty arry and setBooks method is used to update the value of books with the returned data\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),books=_useState4[0],setBooks=_useState4[1];//how to handle slow search reaspone while waiting for data\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),clickList=_useState10[0],setClickList=_useState10[1];//format input to replace spaces with '+'\nvar formatSearchTerm=searchTerm.split(' ').join('+');var onInputChange=function onInputChange(e){setSearchTerm(e.target.value);};var API_URL=\"https://openlibrary.org/search.json?q=\".concat(formatSearchTerm);var fetchBooks=function fetchBooks(){setLoading(true);fetch(\"\".concat(API_URL)).then(function(response){return response.json();})// Books result\n.then(function(data){return setBooks(data.docs);}).then(function(){return setLoading();}).catch(setError);};if(loading){return/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:\"center\"},children:\"Searching Library...\"});}if(error){return/*#__PURE__*/_jsx(\"pre\",{children:JSON.stringify(error,null,2)});}if(!books){return null;}// Submit handler\nvar onSubmitHandler=function onSubmitHandler(search){// Prevent browser refreshing after form submission\nsearch.preventDefault();// Call fetch books async function\nfetchBooks();};var year=[];function publishYear(obj){for(var i in obj){var _publishYear=obj[i].publish_year;// console.log(publishYear);\nfor(var p in _publishYear){year.push(_publishYear[p]);}}};publishYear(books);// let frequency= {}; \n// for(var i=0; i<year.length; ++i){\n//   if(!frequency[year[i]])\n//   frequency[year[i]] = 0;\n//   ++frequency[year[i]];\n// };\n// console.log(year);\nvar sorted=year.slice().sort(function(a,b){return a-b;});var smallest=sorted[0],largest=sorted[sorted.length-1],yearSpan=largest-smallest;function nodeClick(event){var clickBook=[];var data=event.datum.data;for(var book in data){clickBook.push(data[book]);}setClickList(clickBook);}var options={autoSize:true,title:{enabled:true,text:\"Results for \\\"\".concat(searchTerm,\"\\\"\"),color:'black',fontWeight:'bold',fontSize:20},data:books,series:[{type:'histogram',xKey:'first_publish_year',xName:'Publicaiton Year',binCount:yearSpan,tooltip:{enabled:false},label:{color:'#247',fontSize:9,fontWeight:'bold'},fill:'#247',stroke:'#fff',highlightStyle:{fill:'rgba(0, 116, 255, 0.74)'},listeners:{nodeClick:nodeClick}}],legend:{enabled:false},navigator:{enabled:true},axes:[{type:'number',position:'bottom',title:{enabled:true,text:'Year of Publication'}},{type:'number',position:'left',title:{enabled:true,text:'Number of Book Results'},tick:{width:1,size:6,count:5}}]};return/*#__PURE__*/_jsxs(\"div\",{className:\"body\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"title\",children:\"Search Open Library\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"Search\",onSubmit:onSubmitHandler,children:[/*#__PURE__*/_jsx(\"input\",{className:\"input-field\",type:\"search\",placeholder:\"Enter Term to Search by\",value:searchTerm,onChange:onInputChange}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",type:\"submit\",children:\"Find\"})]}),/*#__PURE__*/_jsx(AgChartsReact,{options:options,className:\"chart\"}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"ul\",{children:clickList.map(function(book,index){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"list\",children:[/*#__PURE__*/_jsx(\"img\",{alt:\"\".concat(book.title,\" book\"),src:\"http:////covers.openlibrary.org/b/olid/\".concat(book.cover_edition_key,\"-M.jpg\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"list-item\",children:[/*#__PURE__*/_jsx(\"h3\",{children:book.title}),/*#__PURE__*/_jsx(\"p\",{children:\"Author: \".concat(book.author_name)}),/*#__PURE__*/_jsx(\"p\",{children:\"Year first published: \".concat(book.publish_year)})]})]}),/*#__PURE__*/_jsx(\"hr\",{})]},index);})})})]});};export default App;","map":{"version":3,"sources":["/Users/julianneagresta/Projects/openlibrary-search-histogram/src/App.js"],"names":["React","useState","AgChartsReact","App","searchTerm","setSearchTerm","books","setBooks","loading","setLoading","error","setError","clickList","setClickList","formatSearchTerm","split","join","onInputChange","e","target","value","API_URL","fetchBooks","fetch","then","response","json","data","docs","catch","textAlign","JSON","stringify","onSubmitHandler","search","preventDefault","year","publishYear","obj","i","publish_year","p","push","sorted","slice","sort","a","b","smallest","largest","length","yearSpan","nodeClick","event","clickBook","datum","book","options","autoSize","title","enabled","text","color","fontWeight","fontSize","series","type","xKey","xName","binCount","tooltip","label","fill","stroke","highlightStyle","listeners","legend","navigator","axes","position","tick","width","size","count","map","index","cover_edition_key","author_name"],"mappings":"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","sourcesContent":["// quaternion algebra\n// useState will be used to handle to slow search by returning a pair representing the current state and then a function to update the state respectively\nimport React, {useState} from 'react';\nimport './App.css';\nimport { AgChartsReact} from 'ag-charts-react';\n\n\nconst App = () => {\n  //store data from search terms using useState where searchTerm is set to empty string. The setSearchTerm is updated with the input\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  //store data from API where books is set to an empty arry and setBooks method is used to update the value of books with the returned data\n  const [books, setBooks] = useState([]);\n  //how to handle slow search reaspone while waiting for data\n  const [loading, setLoading]= useState(false);\n  const [error, setError] = useState(null);\n  const [clickList, setClickList] = useState([]);\n\n  //format input to replace spaces with '+'\n  const formatSearchTerm = searchTerm.split(' ').join('+');\n  \n\n  const onInputChange= (e) => {\n    setSearchTerm(e.target.value);\n  };\n\n  let API_URL = `https://openlibrary.org/search.json?q=${formatSearchTerm}`;\n  \n  const fetchBooks = () => {\n      setLoading(true);\n      fetch(`${API_URL}`)\n      .then((response) => response.json())\n      // Books result\n      .then((data) => setBooks(data.docs))\n      .then(() => setLoading())\n      .catch(setError);\n  };\n\n  if (loading) {\n    return <h1 style={{textAlign: \"center\" }}>Searching Library...</h1>;\n  }\n  if (error) {\n    return <pre>{JSON.stringify(error, null, 2)}</pre>;\n  }\n  if (!books) {\n    return null;\n  }\n\n  \n  // Submit handler\n  const onSubmitHandler = (search) => {\n    // Prevent browser refreshing after form submission\n    search.preventDefault();\n    // Call fetch books async function\n    fetchBooks();\n  };\n\n  let year = [];\n  function publishYear(obj){ \n    for (let i in obj){\n      let publishYear = obj[i].publish_year;\n      // console.log(publishYear);\n      for(let p in publishYear){\n        year.push(publishYear[p]);\n      }\n    }\n\n  };\n\npublishYear(books);\n\n\n// let frequency= {}; \n// for(var i=0; i<year.length; ++i){\n//   if(!frequency[year[i]])\n//   frequency[year[i]] = 0;\n//   ++frequency[year[i]];\n// };\n\n// console.log(year);\n\nvar sorted = year.slice().sort(function(a, b) {\n  return a - b;\n});\n\nvar smallest = sorted[0],                                 \n    largest  = sorted[sorted.length - 1],\n    yearSpan = largest-smallest;\n\nfunction nodeClick (event) {\n  let clickBook = [];\n  var data = event.datum.data;\n  for (var book in data){\n    clickBook.push(data[book])\n  } \n  setClickList(clickBook);\n}\n  const options = {\n    autoSize: true,\n    title: {\n      enabled: true,\n      text: `Results for \"${searchTerm}\"`,\n      color: 'black', \n      fontWeight: 'bold',\n      fontSize: 20,\n    },\n    data: books,\n    series: [\n      {\n        type: 'histogram',\n        xKey: 'first_publish_year',\n        xName: 'Publicaiton Year',\n        binCount: yearSpan,\n        tooltip:{\n          enabled: false,\n        },\n        label: {\n          color: '#247',\n          fontSize:9,\n          fontWeight: 'bold',\n  \n        },\n        fill: '#247', \n        stroke: '#fff',\n        highlightStyle: {\n          fill: 'rgba(0, 116, 255, 0.74)'\n        },\n        listeners: {\n          nodeClick: nodeClick,\n        },\n      },\n    ],\n    legend: {\n      enabled: false\n    },\n    navigator: {\n      enabled: true,\n    },\n    axes: [\n      {\n        type: 'number',\n        position: 'bottom',\n        title: {\n          enabled: true,\n          text: 'Year of Publication'\n        },\n      },\n      {\n        type: 'number',\n        position: 'left',\n        title: {\n          enabled: true,\n          text: 'Number of Book Results'\n        },\n        tick: {\n          width: 1,\n          size: 6,\n          count: 5\n        },\n      },\n    ],\n  };\n\n  return (\n    <div className=\"body\">\n      <h2 className=\"title\">Search Open Library</h2>\n      <form className=\"Search\" onSubmit={onSubmitHandler}>\n            <input\n            className=\"input-field\"\n            type=\"search\"\n            placeholder=\"Enter Term to Search by\"\n            value={searchTerm}\n            onChange={onInputChange}\n            />\n            <button className=\"button\" type=\"submit\">Find</button>\n        </form>\n      <AgChartsReact options={options} className='chart' />\n      <div className = 'container'>\n        <ul >\n          {\n            clickList.map((book, index) => {\n              return (\n                <li key={index}>\n                  <div className = 'list'>\n                    <img alt={`${book.title} book`} src={`http:////covers.openlibrary.org/b/olid/${book.cover_edition_key}-M.jpg`} />\n                    <div className = 'list-item'>\n                      \n                      <h3>{book.title}</h3>\n                      <p>{`Author: ${book.author_name}`}</p>\n                      <p>{`Year first published: ${book.publish_year}`}</p>\n                    </div>\n                  </div>\n                  <hr />\n                </li>\n              );\n            })\n          }\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}