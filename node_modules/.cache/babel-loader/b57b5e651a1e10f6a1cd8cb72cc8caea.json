{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Scene } from \"../scene/scene\";\nimport { Group } from \"../scene/group\";\nimport { Padding } from \"../util/padding\";\nimport { Shape } from \"../scene/shape/shape\";\nimport { Rect } from \"../scene/shape/rect\";\nimport { Legend } from \"./legend\";\nimport { BBox } from \"../scene/bbox\";\nimport { find } from \"../util/array\";\nimport { SizeMonitor } from \"../util/sizeMonitor\";\nimport { Observable, reactive } from \"../util/observable\";\nimport { createId } from \"../util/id\";\nimport { placeLabels } from \"../util/labelPlacement\";\nvar defaultTooltipCss = \"\\n.ag-chart-tooltip {\\n    display: table;\\n    position: absolute;\\n    user-select: none;\\n    pointer-events: none;\\n    white-space: nowrap;\\n    z-index: 99999;\\n    font: 12px Verdana, sans-serif;\\n    color: black;\\n    background: rgb(244, 244, 244);\\n    border-radius: 5px;\\n    box-shadow: 0 0 1px rgba(3, 3, 3, 0.7), 0.5vh 0.5vh 1vh rgba(3, 3, 3, 0.25);\\n}\\n\\n.ag-chart-tooltip-hidden {\\n    top: -10000px !important;\\n}\\n\\n.ag-chart-tooltip-title {\\n    font-weight: bold;\\n    padding: 7px;\\n    border-top-left-radius: 5px;\\n    border-top-right-radius: 5px;\\n    color: white;\\n    background-color: #888888;\\n    border-top-left-radius: 5px;\\n    border-top-right-radius: 5px;\\n}\\n\\n.ag-chart-tooltip-content {\\n    padding: 7px;\\n    line-height: 1.7em;\\n    border-bottom-left-radius: 5px;\\n    border-bottom-right-radius: 5px;\\n    overflow: hidden;\\n}\\n\\n.ag-chart-tooltip-content:empty {\\n    padding: 0;\\n    height: 7px;\\n}\\n\\n.ag-chart-tooltip-arrow::before {\\n    content: \\\"\\\";\\n\\n    position: absolute;\\n    top: 100%;\\n    left: 50%;\\n    transform: translateX(-50%);\\n\\n    border: 6px solid #989898;\\n\\n    border-left-color: transparent;\\n    border-right-color: transparent;\\n    border-top-color: #989898;\\n    border-bottom-color: transparent;\\n\\n    width: 0;\\n    height: 0;\\n\\n    margin: 0 auto;\\n}\\n\\n.ag-chart-tooltip-arrow::after {\\n    content: \\\"\\\";\\n\\n    position: absolute;\\n    top: 100%;\\n    left: 50%;\\n    transform: translateX(-50%);\\n\\n    border: 5px solid black;\\n\\n    border-left-color: transparent;\\n    border-right-color: transparent;\\n    border-top-color: rgb(244, 244, 244);\\n    border-bottom-color: transparent;\\n\\n    width: 0;\\n    height: 0;\\n\\n    margin: 0 auto;\\n}\\n\\n.ag-chart-wrapper {\\n    box-sizing: border-box;\\n    overflow: hidden;\\n}\\n\";\nexport function toTooltipHtml(input, defaults) {\n  if (typeof input === 'string') {\n    return input;\n  }\n\n  defaults = defaults || {};\n  var _a = input.content,\n      content = _a === void 0 ? defaults.content || '' : _a,\n      _b = input.title,\n      title = _b === void 0 ? defaults.title || undefined : _b,\n      _c = input.color,\n      color = _c === void 0 ? defaults.color || 'white' : _c,\n      _d = input.backgroundColor,\n      backgroundColor = _d === void 0 ? defaults.backgroundColor || '#888' : _d;\n  var titleHtml = title ? \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-title\\\"\\n        style=\\\"color: \" + color + \"; background-color: \" + backgroundColor + \"\\\">\" + title + \"</div>\" : '';\n  return titleHtml + \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-content\\\">\" + content + \"</div>\";\n}\n\nvar ChartTooltip = function (_super) {\n  __extends(ChartTooltip, _super);\n\n  function ChartTooltip(chart) {\n    var _this = _super.call(this) || this;\n\n    _this.element = document.createElement('div');\n    _this.enabled = true;\n    _this.class = Chart.defaultTooltipClass;\n    _this.delay = 0;\n    /**\n     * If `true`, the tooltip will be shown for the marker closest to the mouse cursor.\n     * Only has effect on series with markers.\n     */\n\n    _this.tracking = true;\n    _this.showTimeout = 0;\n    _this.constrained = false;\n    _this.chart = chart;\n    _this.class = '';\n    var tooltipRoot = document.body;\n    tooltipRoot.appendChild(_this.element); // Detect when the chart becomes invisible and hide the tooltip as well.\n\n    if (window.IntersectionObserver) {\n      var target_1 = _this.chart.scene.canvas.element;\n      var observer = new IntersectionObserver(function (entries) {\n        for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n          var entry = entries_1[_i];\n\n          if (entry.target === target_1 && entry.intersectionRatio === 0) {\n            _this.toggle(false);\n          }\n        }\n      }, {\n        root: tooltipRoot\n      });\n      observer.observe(target_1);\n      _this.observer = observer;\n    }\n\n    return _this;\n  }\n\n  ChartTooltip.prototype.isVisible = function () {\n    var element = this.element;\n\n    if (element.classList) {\n      // if not IE11\n      return !element.classList.contains(Chart.defaultTooltipClass + '-hidden');\n    } // IE11 part.\n\n\n    var classes = element.getAttribute('class');\n\n    if (classes) {\n      return classes.split(' ').indexOf(Chart.defaultTooltipClass + '-hidden') < 0;\n    }\n\n    return false;\n  };\n\n  ChartTooltip.prototype.updateClass = function (visible, constrained) {\n    var classList = [Chart.defaultTooltipClass, this.class];\n\n    if (visible !== true) {\n      classList.push(Chart.defaultTooltipClass + \"-hidden\");\n    }\n\n    if (constrained !== true) {\n      classList.push(Chart.defaultTooltipClass + \"-arrow\");\n    }\n\n    this.element.setAttribute('class', classList.join(' '));\n  };\n  /**\n   * Shows tooltip at the given event's coordinates.\n   * If the `html` parameter is missing, moves the existing tooltip to the new position.\n   */\n\n\n  ChartTooltip.prototype.show = function (meta, html, instantly) {\n    var _this = this;\n\n    if (instantly === void 0) {\n      instantly = false;\n    }\n\n    var el = this.element;\n\n    if (html !== undefined) {\n      el.innerHTML = html;\n    } else if (!el.innerHTML) {\n      return;\n    }\n\n    var left = meta.pageX - el.clientWidth / 2;\n    var top = meta.pageY - el.clientHeight - 8;\n    this.constrained = false;\n\n    if (this.chart.container) {\n      var tooltipRect = el.getBoundingClientRect();\n      var minLeft = 0;\n      var maxLeft = window.innerWidth - tooltipRect.width;\n\n      if (left < minLeft) {\n        left = minLeft;\n        this.updateClass(true, this.constrained = true);\n      } else if (left > maxLeft) {\n        left = maxLeft;\n        this.updateClass(true, this.constrained = true);\n      }\n\n      if (top < window.pageYOffset) {\n        top = meta.pageY + 20;\n        this.updateClass(true, this.constrained = true);\n      }\n    }\n\n    el.style.left = Math.round(left) + \"px\";\n    el.style.top = Math.round(top) + \"px\";\n\n    if (this.delay > 0 && !instantly) {\n      this.toggle(false);\n      this.showTimeout = window.setTimeout(function () {\n        _this.toggle(true);\n      }, this.delay);\n      return;\n    }\n\n    this.toggle(true);\n  };\n\n  ChartTooltip.prototype.toggle = function (visible) {\n    if (!visible) {\n      window.clearTimeout(this.showTimeout);\n\n      if (this.chart.lastPick && !this.delay) {\n        this.chart.dehighlightDatum();\n        this.chart.lastPick = undefined;\n      }\n    }\n\n    this.updateClass(visible, this.constrained);\n  };\n\n  ChartTooltip.prototype.destroy = function () {\n    var parentNode = this.element.parentNode;\n\n    if (parentNode) {\n      parentNode.removeChild(this.element);\n    }\n\n    if (this.observer) {\n      this.observer.unobserve(this.chart.scene.canvas.element);\n    }\n  };\n\n  __decorate([reactive()], ChartTooltip.prototype, \"enabled\", void 0);\n\n  __decorate([reactive()], ChartTooltip.prototype, \"class\", void 0);\n\n  __decorate([reactive()], ChartTooltip.prototype, \"delay\", void 0);\n\n  __decorate([reactive()], ChartTooltip.prototype, \"tracking\", void 0);\n\n  return ChartTooltip;\n}(Observable);\n\nexport { ChartTooltip };\n\nvar Chart = function (_super) {\n  __extends(Chart, _super);\n\n  function Chart(document) {\n    if (document === void 0) {\n      document = window.document;\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.id = createId(_this);\n    _this.background = new Rect();\n    _this.legend = new Legend();\n    _this.legendAutoPadding = new Padding();\n    _this.captionAutoPadding = 0; // top padding only\n\n    _this._container = undefined;\n    _this._data = [];\n    _this._autoSize = false;\n    _this.padding = new Padding(20);\n    _this._axes = [];\n    _this._series = [];\n    _this._axesChanged = false;\n    _this._seriesChanged = false;\n    _this.layoutCallbackId = 0;\n\n    _this._performLayout = function () {\n      _this.layoutCallbackId = 0;\n      _this.background.width = _this.width;\n      _this.background.height = _this.height;\n\n      _this.performLayout();\n\n      if (!_this.layoutPending) {\n        _this.fireEvent({\n          type: 'layoutDone'\n        });\n      }\n    };\n\n    _this.dataCallbackId = 0;\n    _this.nodeData = new Map();\n    _this.legendBBox = new BBox(0, 0, 0, 0);\n    _this._onMouseDown = _this.onMouseDown.bind(_this);\n    _this._onMouseMove = _this.onMouseMove.bind(_this);\n    _this._onMouseUp = _this.onMouseUp.bind(_this);\n    _this._onMouseOut = _this.onMouseOut.bind(_this);\n    _this._onClick = _this.onClick.bind(_this);\n    _this.pointerInsideLegend = false;\n    var root = new Group();\n    var background = _this.background;\n    background.fill = 'white';\n    root.appendChild(background);\n    var element = _this._element = document.createElement('div');\n    element.setAttribute('class', 'ag-chart-wrapper');\n    var scene = new Scene(document);\n    _this.scene = scene;\n    scene.root = root;\n    scene.container = element;\n    _this.autoSize = true;\n    var legend = _this.legend;\n    legend.addEventListener('layoutChange', _this.onLayoutChange, _this);\n    legend.item.label.addPropertyListener('formatter', _this.updateLegend, _this);\n    legend.addPropertyListener('position', _this.onLegendPositionChange, _this);\n    _this.tooltip = new ChartTooltip(_this);\n\n    _this.tooltip.addPropertyListener('class', function () {\n      return _this.tooltip.toggle();\n    });\n\n    if (Chart.tooltipDocuments.indexOf(document) < 0) {\n      var styleElement = document.createElement('style');\n      styleElement.innerHTML = defaultTooltipCss; // Make sure the default tooltip style goes before other styles so it can be overridden.\n\n      document.head.insertBefore(styleElement, document.head.querySelector('style'));\n      Chart.tooltipDocuments.push(document);\n    }\n\n    _this.setupDomListeners(scene.canvas.element);\n\n    _this.addPropertyListener('title', _this.onCaptionChange);\n\n    _this.addPropertyListener('subtitle', _this.onCaptionChange);\n\n    _this.addEventListener('layoutChange', function () {\n      return _this.layoutPending = true;\n    });\n\n    return _this;\n  }\n\n  Object.defineProperty(Chart.prototype, \"container\", {\n    get: function get() {\n      return this._container;\n    },\n    set: function set(value) {\n      if (this._container !== value) {\n        var parentNode = this.element.parentNode;\n\n        if (parentNode != null) {\n          parentNode.removeChild(this.element);\n        }\n\n        if (value) {\n          value.appendChild(this.element);\n        }\n\n        this._container = value;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"data\", {\n    get: function get() {\n      return this._data;\n    },\n    set: function set(data) {\n      this._data = data;\n      this.series.forEach(function (series) {\n        return series.data = data;\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"width\", {\n    get: function get() {\n      return this.scene.width;\n    },\n    set: function set(value) {\n      this.autoSize = false;\n\n      if (this.width !== value) {\n        this.scene.resize(value, this.height);\n        this.fireEvent({\n          type: 'layoutChange'\n        });\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"height\", {\n    get: function get() {\n      return this.scene.height;\n    },\n    set: function set(value) {\n      this.autoSize = false;\n\n      if (this.height !== value) {\n        this.scene.resize(this.width, value);\n        this.fireEvent({\n          type: 'layoutChange'\n        });\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"autoSize\", {\n    get: function get() {\n      return this._autoSize;\n    },\n    set: function set(value) {\n      if (this._autoSize !== value) {\n        this._autoSize = value;\n        var style = this.element.style;\n\n        if (value) {\n          var chart_1 = this; // capture `this` for IE11\n\n          SizeMonitor.observe(this.element, function (size) {\n            if (size.width !== chart_1.width || size.height !== chart_1.height) {\n              chart_1.scene.resize(size.width, size.height);\n              chart_1.fireEvent({\n                type: 'layoutChange'\n              });\n            }\n          });\n          style.display = 'block';\n          style.width = '100%';\n          style.height = '100%';\n        } else {\n          SizeMonitor.unobserve(this.element);\n          style.display = 'inline-block';\n          style.width = 'auto';\n          style.height = 'auto';\n        }\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Chart.prototype.download = function (fileName) {\n    this.scene.download(fileName);\n  };\n\n  Chart.prototype.destroy = function () {\n    this.tooltip.destroy();\n    SizeMonitor.unobserve(this.element);\n    this.container = undefined;\n    this.cleanupDomListeners(this.scene.canvas.element);\n    this.scene.container = undefined;\n  };\n\n  Chart.prototype.onLayoutChange = function () {\n    this.layoutPending = true;\n  };\n\n  Chart.prototype.onLegendPositionChange = function () {\n    this.legendAutoPadding.clear();\n    this.layoutPending = true;\n  };\n\n  Chart.prototype.onCaptionChange = function (event) {\n    var value = event.value,\n        oldValue = event.oldValue;\n\n    if (oldValue) {\n      oldValue.removeEventListener('change', this.onLayoutChange, this);\n      this.scene.root.removeChild(oldValue.node);\n    }\n\n    if (value) {\n      value.addEventListener('change', this.onLayoutChange, this);\n      this.scene.root.appendChild(value.node);\n    }\n  };\n\n  Object.defineProperty(Chart.prototype, \"element\", {\n    get: function get() {\n      return this._element;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"axes\", {\n    get: function get() {\n      return this._axes;\n    },\n    set: function set(values) {\n      var _this = this;\n\n      this._axes.forEach(function (axis) {\n        return _this.detachAxis(axis);\n      }); // make linked axes go after the regular ones (simulates stable sort by `linkedTo` property)\n\n\n      this._axes = values.filter(function (a) {\n        return !a.linkedTo;\n      }).concat(values.filter(function (a) {\n        return a.linkedTo;\n      }));\n\n      this._axes.forEach(function (axis) {\n        return _this.attachAxis(axis);\n      });\n\n      this.axesChanged = true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Chart.prototype.attachAxis = function (axis) {\n    this.scene.root.insertBefore(axis.group, this.seriesRoot);\n  };\n\n  Chart.prototype.detachAxis = function (axis) {\n    this.scene.root.removeChild(axis.group);\n  };\n\n  Object.defineProperty(Chart.prototype, \"series\", {\n    get: function get() {\n      return this._series;\n    },\n    set: function set(values) {\n      var _this = this;\n\n      this.removeAllSeries();\n      values.forEach(function (series) {\n        return _this.addSeries(series);\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Chart.prototype.scheduleLayout = function () {\n    this.layoutPending = true;\n  };\n\n  Chart.prototype.scheduleData = function () {\n    // To prevent the chart from thinking the cursor is over the same node\n    // after a change to data (the nodes are reused on data changes).\n    this.dehighlightDatum();\n    this.dataPending = true;\n  };\n\n  Chart.prototype.addSeries = function (series, before) {\n    var _a = this,\n        allSeries = _a.series,\n        seriesRoot = _a.seriesRoot;\n\n    var canAdd = allSeries.indexOf(series) < 0;\n\n    if (canAdd) {\n      var beforeIndex = before ? allSeries.indexOf(before) : -1;\n\n      if (beforeIndex >= 0) {\n        allSeries.splice(beforeIndex, 0, series);\n        seriesRoot.insertBefore(series.group, before.group);\n      } else {\n        allSeries.push(series);\n        seriesRoot.append(series.group);\n      }\n\n      this.initSeries(series);\n      this.seriesChanged = true;\n      this.axesChanged = true;\n      return true;\n    }\n\n    return false;\n  };\n\n  Chart.prototype.initSeries = function (series) {\n    series.chart = this;\n\n    if (!series.data) {\n      series.data = this.data;\n    }\n\n    series.addEventListener('layoutChange', this.scheduleLayout, this);\n    series.addEventListener('dataChange', this.scheduleData, this);\n    series.addEventListener('legendChange', this.updateLegend, this);\n    series.addEventListener('nodeClick', this.onSeriesNodeClick, this);\n  };\n\n  Chart.prototype.freeSeries = function (series) {\n    series.chart = undefined;\n    series.removeEventListener('layoutChange', this.scheduleLayout, this);\n    series.removeEventListener('dataChange', this.scheduleData, this);\n    series.removeEventListener('legendChange', this.updateLegend, this);\n    series.removeEventListener('nodeClick', this.onSeriesNodeClick, this);\n  };\n\n  Chart.prototype.addSeriesAfter = function (series, after) {\n    var _a = this,\n        allSeries = _a.series,\n        seriesRoot = _a.seriesRoot;\n\n    var canAdd = allSeries.indexOf(series) < 0;\n\n    if (canAdd) {\n      var afterIndex = after ? this.series.indexOf(after) : -1;\n\n      if (afterIndex >= 0) {\n        if (afterIndex + 1 < allSeries.length) {\n          seriesRoot.insertBefore(series.group, allSeries[afterIndex + 1].group);\n        } else {\n          seriesRoot.append(series.group);\n        }\n\n        this.initSeries(series);\n        allSeries.splice(afterIndex + 1, 0, series);\n      } else {\n        if (allSeries.length > 0) {\n          seriesRoot.insertBefore(series.group, allSeries[0].group);\n        } else {\n          seriesRoot.append(series.group);\n        }\n\n        this.initSeries(series);\n        allSeries.unshift(series);\n      }\n\n      this.seriesChanged = true;\n      this.axesChanged = true;\n    }\n\n    return false;\n  };\n\n  Chart.prototype.removeSeries = function (series) {\n    var index = this.series.indexOf(series);\n\n    if (index >= 0) {\n      this.series.splice(index, 1);\n      this.freeSeries(series);\n      this.seriesRoot.removeChild(series.group);\n      this.seriesChanged = true;\n      return true;\n    }\n\n    return false;\n  };\n\n  Chart.prototype.removeAllSeries = function () {\n    var _this = this;\n\n    this.series.forEach(function (series) {\n      _this.freeSeries(series);\n\n      _this.seriesRoot.removeChild(series.group);\n    });\n    this._series = []; // using `_series` instead of `series` to prevent infinite recursion\n\n    this.seriesChanged = true;\n  };\n\n  Chart.prototype.assignSeriesToAxes = function () {\n    var _this = this;\n\n    this.axes.forEach(function (axis) {\n      var axisName = axis.direction + 'Axis';\n      var boundSeries = [];\n\n      _this.series.forEach(function (series) {\n        if (series[axisName] === axis) {\n          boundSeries.push(series);\n        }\n      });\n\n      axis.boundSeries = boundSeries;\n    });\n    this.seriesChanged = false;\n  };\n\n  Chart.prototype.assignAxesToSeries = function (force) {\n    var _this = this;\n\n    if (force === void 0) {\n      force = false;\n    } // This method has to run before `assignSeriesToAxes`.\n\n\n    var directionToAxesMap = {};\n    this.axes.forEach(function (axis) {\n      var direction = axis.direction;\n      var directionAxes = directionToAxesMap[direction] || (directionToAxesMap[direction] = []);\n      directionAxes.push(axis);\n    });\n    this.series.forEach(function (series) {\n      series.directions.forEach(function (direction) {\n        var axisName = direction + 'Axis';\n\n        if (!series[axisName] || force) {\n          var directionAxes = directionToAxesMap[direction];\n\n          if (directionAxes) {\n            var axis = _this.findMatchingAxis(directionAxes, series.getKeys(direction));\n\n            if (axis) {\n              series[axisName] = axis;\n            }\n          }\n        }\n      });\n    });\n    this.axesChanged = false;\n  };\n\n  Chart.prototype.findMatchingAxis = function (directionAxes, directionKeys) {\n    for (var i = 0; i < directionAxes.length; i++) {\n      var axis = directionAxes[i];\n      var axisKeys = axis.keys;\n\n      if (!axisKeys.length) {\n        return axis;\n      } else if (directionKeys) {\n        for (var j = 0; j < directionKeys.length; j++) {\n          if (axisKeys.indexOf(directionKeys[j]) >= 0) {\n            return axis;\n          }\n        }\n      }\n    }\n  };\n\n  Object.defineProperty(Chart.prototype, \"axesChanged\", {\n    get: function get() {\n      return this._axesChanged;\n    },\n    set: function set(value) {\n      this._axesChanged = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"seriesChanged\", {\n    get: function get() {\n      return this._seriesChanged;\n    },\n    set: function set(value) {\n      this._seriesChanged = value;\n\n      if (value) {\n        this.dataPending = true;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"layoutPending\", {\n    /**\n     * Only `true` while we are waiting for the layout to start.\n     * This will be `false` if the layout has already started and is ongoing.\n     */\n    get: function get() {\n      return !!this.layoutCallbackId;\n    },\n    set: function set(value) {\n      if (value) {\n        if (!(this.layoutCallbackId || this.dataPending)) {\n          this.layoutCallbackId = requestAnimationFrame(this._performLayout);\n        }\n      } else if (this.layoutCallbackId) {\n        cancelAnimationFrame(this.layoutCallbackId);\n        this.layoutCallbackId = 0;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"dataPending\", {\n    get: function get() {\n      return !!this.dataCallbackId;\n    },\n    set: function set(value) {\n      var _this = this;\n\n      if (this.dataCallbackId) {\n        clearTimeout(this.dataCallbackId);\n        this.dataCallbackId = 0;\n      }\n\n      if (value) {\n        this.dataCallbackId = window.setTimeout(function () {\n          _this.dataPending = false;\n\n          _this.processData();\n        }, 0);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Chart.prototype.processData = function () {\n    this.layoutPending = false;\n\n    if (this.axesChanged) {\n      this.assignAxesToSeries(true);\n      this.assignSeriesToAxes();\n    }\n\n    if (this.seriesChanged) {\n      this.assignSeriesToAxes();\n    }\n\n    this.series.forEach(function (s) {\n      return s.processData();\n    });\n    this.updateLegend();\n    this.layoutPending = true;\n  };\n\n  Chart.prototype.generateNodeData = function () {\n    var _this = this;\n\n    this.nodeData.clear();\n    this.series.forEach(function (s) {\n      var data = s.visible ? s.generateNodeData() : [];\n\n      _this.nodeData.set(s, data);\n    });\n  };\n\n  Chart.prototype.placeLabels = function () {\n    var series = [];\n    var data = [];\n    this.nodeData.forEach(function (d, s) {\n      if (s.visible && s.label.enabled) {\n        series.push(s);\n        data.push(s.getLabelData());\n      }\n    });\n    var seriesRect = this.seriesRect;\n    var labels = seriesRect ? placeLabels(data, {\n      x: 0,\n      y: 0,\n      width: seriesRect.width,\n      height: seriesRect.height\n    }) : [];\n    return new Map(labels.map(function (l, i) {\n      return [series[i], l];\n    }));\n  };\n\n  Chart.prototype.updateLegend = function () {\n    var legendData = [];\n    this.series.filter(function (s) {\n      return s.showInLegend;\n    }).forEach(function (series) {\n      return series.listSeriesItems(legendData);\n    });\n    var formatter = this.legend.item.label.formatter;\n\n    if (formatter) {\n      legendData.forEach(function (datum) {\n        return datum.label.text = formatter({\n          id: datum.id,\n          itemId: datum.itemId,\n          value: datum.label.text\n        });\n      });\n    }\n\n    this.legend.data = legendData;\n  };\n\n  Chart.prototype.positionCaptions = function () {\n    var _a = this,\n        title = _a.title,\n        subtitle = _a.subtitle;\n\n    var titleVisible = false;\n    var subtitleVisible = false;\n    var spacing = 10;\n    var paddingTop = spacing;\n\n    if (title && title.enabled) {\n      title.node.x = this.width / 2;\n      title.node.y = paddingTop;\n      titleVisible = true;\n      var titleBBox = title.node.computeBBox(); // make sure to set node's x/y, then computeBBox\n\n      if (titleBBox) {\n        paddingTop = titleBBox.y + titleBBox.height;\n      }\n\n      if (subtitle && subtitle.enabled) {\n        subtitle.node.x = this.width / 2;\n        subtitle.node.y = paddingTop + spacing;\n        subtitleVisible = true;\n        var subtitleBBox = subtitle.node.computeBBox();\n\n        if (subtitleBBox) {\n          paddingTop = subtitleBBox.y + subtitleBBox.height;\n        }\n      }\n    }\n\n    if (title) {\n      title.node.visible = titleVisible;\n    }\n\n    if (subtitle) {\n      subtitle.node.visible = subtitleVisible;\n    }\n\n    this.captionAutoPadding = Math.floor(paddingTop);\n  };\n\n  Chart.prototype.positionLegend = function () {\n    if (!this.legend.enabled || !this.legend.data.length) {\n      return;\n    }\n\n    var _a = this,\n        legend = _a.legend,\n        captionAutoPadding = _a.captionAutoPadding,\n        legendAutoPadding = _a.legendAutoPadding;\n\n    var width = this.width;\n    var height = this.height - captionAutoPadding;\n    var legendGroup = legend.group;\n    var legendSpacing = legend.spacing;\n    var translationX = 0;\n    var translationY = 0;\n    var legendBBox;\n\n    switch (legend.position) {\n      case 'bottom':\n        legend.performLayout(width - legendSpacing * 2, 0);\n        legendBBox = legendGroup.computeBBox();\n        translationX = (width - legendBBox.width) / 2 - legendBBox.x;\n        translationY = captionAutoPadding + height - legendBBox.height - legendBBox.y - legendSpacing;\n        legendAutoPadding.bottom = legendBBox.height;\n        break;\n\n      case 'top':\n        legend.performLayout(width - legendSpacing * 2, 0);\n        legendBBox = legendGroup.computeBBox();\n        translationX = (width - legendBBox.width) / 2 - legendBBox.x;\n        translationY = captionAutoPadding + legendSpacing - legendBBox.y;\n        legendAutoPadding.top = legendBBox.height;\n        break;\n\n      case 'left':\n        legend.performLayout(0, height - legendSpacing * 2);\n        legendBBox = legendGroup.computeBBox();\n        translationX = legendSpacing - legendBBox.x;\n        translationY = captionAutoPadding + (height - legendBBox.height) / 2 - legendBBox.y;\n        legendAutoPadding.left = legendBBox.width;\n        break;\n\n      default:\n        // case 'right':\n        legend.performLayout(0, height - legendSpacing * 2);\n        legendBBox = legendGroup.computeBBox();\n        translationX = width - legendBBox.width - legendBBox.x - legendSpacing;\n        translationY = captionAutoPadding + (height - legendBBox.height) / 2 - legendBBox.y;\n        legendAutoPadding.right = legendBBox.width;\n        break;\n    } // Round off for pixel grid alignment to work properly.\n\n\n    legendGroup.translationX = Math.floor(translationX + legendGroup.translationX);\n    legendGroup.translationY = Math.floor(translationY + legendGroup.translationY);\n    this.legendBBox = legendGroup.computeBBox();\n  };\n\n  Chart.prototype.setupDomListeners = function (chartElement) {\n    chartElement.addEventListener('mousedown', this._onMouseDown);\n    chartElement.addEventListener('mousemove', this._onMouseMove);\n    chartElement.addEventListener('mouseup', this._onMouseUp);\n    chartElement.addEventListener('mouseout', this._onMouseOut);\n    chartElement.addEventListener('click', this._onClick);\n  };\n\n  Chart.prototype.cleanupDomListeners = function (chartElement) {\n    chartElement.removeEventListener('mousedown', this._onMouseDown);\n    chartElement.removeEventListener('mousemove', this._onMouseMove);\n    chartElement.removeEventListener('mouseup', this._onMouseUp);\n    chartElement.removeEventListener('mouseout', this._onMouseOut);\n    chartElement.removeEventListener('click', this._onClick);\n  };\n\n  Chart.prototype.getSeriesRect = function () {\n    return this.seriesRect;\n  }; // x/y are local canvas coordinates in CSS pixels, not actual pixels\n\n\n  Chart.prototype.pickSeriesNode = function (x, y) {\n    if (!(this.seriesRect && this.seriesRect.containsPoint(x, y))) {\n      return undefined;\n    }\n\n    var allSeries = this.series;\n    var node = undefined;\n\n    for (var i = allSeries.length - 1; i >= 0; i--) {\n      var series = allSeries[i];\n\n      if (!series.visible) {\n        continue;\n      }\n\n      node = series.pickGroup.pickNode(x, y);\n\n      if (node) {\n        return {\n          series: series,\n          node: node\n        };\n      }\n    }\n  }; // Provided x/y are in canvas coordinates.\n\n\n  Chart.prototype.pickClosestSeriesNodeDatum = function (x, y) {\n    if (!this.seriesRect || !this.seriesRect.containsPoint(x, y)) {\n      return undefined;\n    }\n\n    var allSeries = this.series;\n\n    function getDistance(p1, p2) {\n      return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n    }\n\n    var minDistance = Infinity;\n    var closestDatum;\n\n    var _loop_1 = function _loop_1(i) {\n      var series = allSeries[i];\n\n      if (!series.visible) {\n        return \"continue\";\n      }\n\n      var hitPoint = series.group.transformPoint(x, y);\n      series.getNodeData().forEach(function (datum) {\n        if (!datum.point) {\n          return;\n        }\n\n        var distance = getDistance(hitPoint, datum.point);\n\n        if (distance < minDistance) {\n          minDistance = distance;\n          closestDatum = datum;\n        }\n      });\n    };\n\n    for (var i = allSeries.length - 1; i >= 0; i--) {\n      _loop_1(i);\n    }\n\n    if (closestDatum) {\n      return closestDatum;\n    }\n  };\n\n  Chart.prototype.onMouseMove = function (event) {\n    this.handleLegendMouseMove(event);\n\n    if (this.tooltip.enabled) {\n      if (this.tooltip.delay > 0) {\n        this.tooltip.toggle(false);\n      }\n\n      this.handleTooltip(event);\n    }\n  };\n\n  Chart.prototype.handleTooltip = function (event) {\n    var _a = this,\n        lastPick = _a.lastPick,\n        tooltipTracking = _a.tooltip.tracking;\n\n    var offsetX = event.offsetX,\n        offsetY = event.offsetY;\n    var pick = this.pickSeriesNode(offsetX, offsetY);\n    var nodeDatum;\n\n    if (pick && pick.node instanceof Shape) {\n      var node = pick.node;\n      nodeDatum = node.datum;\n\n      if (lastPick && lastPick.datum === nodeDatum) {\n        lastPick.node = node;\n        lastPick.event = event;\n      } // Marker nodes will have the `point` info in their datums.\n      // Highlight if not a marker node or, if not in the tracking mode, highlight markers too.\n\n\n      if (!node.datum.point || !tooltipTracking) {\n        if (!lastPick // cursor moved from empty space to a node\n        || lastPick.node !== node) {\n          // cursor moved from one node to another\n          this.onSeriesDatumPick(event, node.datum, node, event);\n        } else if (pick.series.tooltip.enabled) {\n          // cursor moved within the same node\n          this.tooltip.show(event);\n        } // A non-marker node (takes precedence over marker nodes) was highlighted.\n        // Or we are not in the tracking mode.\n        // Either way, we are done at this point.\n\n\n        return;\n      }\n    }\n\n    var hideTooltip = false; // In tracking mode a tooltip is shown for the closest rendered datum.\n    // This makes it easier to show tooltips when markers are small and/or plentiful\n    // and also gives the ability to show tooltips even when the series were configured\n    // to not render markers.\n\n    if (tooltipTracking) {\n      var closestDatum = this.pickClosestSeriesNodeDatum(offsetX, offsetY);\n\n      if (closestDatum && closestDatum.point) {\n        var _b = closestDatum.point,\n            x = _b.x,\n            y = _b.y;\n        var canvas = this.scene.canvas;\n        var point = closestDatum.series.group.inverseTransformPoint(x, y);\n        var canvasRect = canvas.element.getBoundingClientRect();\n        this.onSeriesDatumPick({\n          pageX: Math.round(canvasRect.left + window.pageXOffset + point.x),\n          pageY: Math.round(canvasRect.top + window.pageYOffset + point.y)\n        }, closestDatum, nodeDatum === closestDatum && pick ? pick.node : undefined, event);\n      } else {\n        hideTooltip = true;\n      }\n    }\n\n    if (lastPick && (hideTooltip || !tooltipTracking)) {\n      // Cursor moved from a non-marker node to empty space.\n      this.dehighlightDatum();\n      this.tooltip.toggle(false);\n      this.lastPick = undefined;\n    }\n  };\n\n  Chart.prototype.onMouseDown = function (event) {};\n\n  Chart.prototype.onMouseUp = function (event) {};\n\n  Chart.prototype.onMouseOut = function (event) {\n    this.tooltip.toggle(false);\n  };\n\n  Chart.prototype.onClick = function (event) {\n    if (this.checkSeriesNodeClick()) {\n      return;\n    }\n\n    if (this.checkLegendClick(event)) {\n      return;\n    }\n\n    this.fireEvent({\n      type: 'click',\n      event: event\n    });\n  };\n\n  Chart.prototype.checkSeriesNodeClick = function () {\n    var lastPick = this.lastPick;\n\n    if (lastPick && lastPick.event && lastPick.node) {\n      var event_1 = lastPick.event,\n          datum = lastPick.datum;\n      datum.series.fireNodeClickEvent(event_1, datum);\n      return true;\n    }\n\n    return false;\n  };\n\n  Chart.prototype.onSeriesNodeClick = function (event) {\n    this.fireEvent(__assign(__assign({}, event), {\n      type: 'seriesNodeClick'\n    }));\n  };\n\n  Chart.prototype.checkLegendClick = function (event) {\n    var datum = this.legend.getDatumForPoint(event.offsetX, event.offsetY);\n\n    if (datum) {\n      var id_1 = datum.id,\n          itemId = datum.itemId,\n          enabled = datum.enabled;\n      var series = find(this.series, function (series) {\n        return series.id === id_1;\n      });\n\n      if (series) {\n        series.toggleSeriesItem(itemId, !enabled);\n\n        if (enabled) {\n          this.tooltip.toggle(false);\n        }\n\n        this.legend.fireEvent({\n          type: 'click',\n          event: event,\n          itemId: itemId,\n          enabled: !enabled\n        });\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  Chart.prototype.handleLegendMouseMove = function (event) {\n    if (!this.legend.enabled) {\n      return;\n    }\n\n    var offsetX = event.offsetX,\n        offsetY = event.offsetY;\n    var datum = this.legend.getDatumForPoint(offsetX, offsetY);\n    var pointerInsideLegend = this.legendBBox.containsPoint(offsetX, offsetY);\n\n    if (pointerInsideLegend) {\n      if (!this.pointerInsideLegend) {\n        this.pointerInsideLegend = true;\n      }\n    } else if (this.pointerInsideLegend) {\n      this.pointerInsideLegend = false; // Undim all series only if the pointer was inside legend is now leaving it.\n\n      this.series.forEach(function (series) {\n        if (series.highlightStyle.series.enabled) {\n          series.undim();\n          series.dehighlight();\n        }\n      });\n      return;\n    }\n\n    if (datum) {\n      var id_2 = datum.id,\n          itemId_1 = datum.itemId;\n      var series_1 = find(this.series, function (series) {\n        return series.id === id_2;\n      });\n\n      if (series_1 && series_1.highlightStyle.series.enabled) {\n        this.series.forEach(function (s) {\n          return s === series_1 ? s.highlight(itemId_1) : s.dim();\n        });\n      }\n    }\n  };\n\n  Chart.prototype.onSeriesDatumPick = function (meta, datum, node, event) {\n    if (this.lastPick) {\n      this.dehighlightDatum();\n    }\n\n    this.lastPick = {\n      datum: datum,\n      node: node,\n      event: event\n    };\n    this.highlightDatum(datum, node);\n    var html = datum.series.tooltip.enabled && datum.series.getTooltipHtml(datum);\n\n    if (html) {\n      this.tooltip.show(meta, html);\n    }\n  };\n\n  Chart.prototype.highlightDatum = function (datum, node) {\n    var style = this.scene.canvas.element.style;\n    this.highlightedDatum = datum;\n    this.series.forEach(function (s) {\n      if (node) {\n        style.cursor = s.cursor;\n      }\n\n      if (s.highlightStyle.series.enabled) {\n        if (s === datum.series) {\n          s.highlight(datum.itemId);\n        } else {\n          s.dim();\n        }\n      }\n\n      s.onHighlightChange();\n    });\n  };\n\n  Chart.prototype.dehighlightDatum = function () {\n    if (this.highlightedDatum) {\n      this.scene.canvas.element.style.cursor = 'default';\n      this.highlightedDatum = undefined;\n      this.series.forEach(function (s) {\n        s.onHighlightChange();\n\n        if (s.highlightStyle.series.enabled) {\n          s.undim();\n          s.dehighlight();\n        }\n      });\n    }\n  };\n\n  Chart.defaultTooltipClass = 'ag-chart-tooltip';\n  Chart.tooltipDocuments = [];\n\n  __decorate([reactive('layoutChange')], Chart.prototype, \"padding\", void 0);\n\n  __decorate([reactive('layoutChange')], Chart.prototype, \"title\", void 0);\n\n  __decorate([reactive('layoutChange')], Chart.prototype, \"subtitle\", void 0);\n\n  return Chart;\n}(Observable);\n\nexport { Chart };","map":{"version":3,"sources":["/Users/julianneagresta/Projects/openlibrary-search-histogram/node_modules/ag-charts-community/dist/es6/chart/chart.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Scene","Group","Padding","Shape","Rect","Legend","BBox","find","SizeMonitor","Observable","reactive","createId","placeLabels","defaultTooltipCss","toTooltipHtml","input","defaults","_a","content","_b","title","undefined","_c","color","_d","backgroundColor","titleHtml","Chart","defaultTooltipClass","ChartTooltip","_super","chart","_this","element","document","createElement","enabled","class","delay","tracking","showTimeout","constrained","tooltipRoot","body","appendChild","window","IntersectionObserver","target_1","scene","canvas","observer","entries","_i","entries_1","entry","intersectionRatio","toggle","root","observe","isVisible","classList","contains","classes","getAttribute","split","indexOf","updateClass","visible","push","setAttribute","join","show","meta","html","instantly","el","innerHTML","left","pageX","clientWidth","top","pageY","clientHeight","container","tooltipRect","getBoundingClientRect","minLeft","maxLeft","innerWidth","width","pageYOffset","style","Math","round","setTimeout","clearTimeout","lastPick","dehighlightDatum","destroy","parentNode","removeChild","unobserve","id","background","legend","legendAutoPadding","captionAutoPadding","_container","_data","_autoSize","padding","_axes","_series","_axesChanged","_seriesChanged","layoutCallbackId","_performLayout","height","performLayout","layoutPending","fireEvent","type","dataCallbackId","nodeData","Map","legendBBox","_onMouseDown","onMouseDown","bind","_onMouseMove","onMouseMove","_onMouseUp","onMouseUp","_onMouseOut","onMouseOut","_onClick","onClick","pointerInsideLegend","fill","_element","autoSize","addEventListener","onLayoutChange","item","label","addPropertyListener","updateLegend","onLegendPositionChange","tooltip","tooltipDocuments","styleElement","head","insertBefore","querySelector","setupDomListeners","onCaptionChange","get","set","value","enumerable","configurable","data","series","forEach","resize","chart_1","size","display","download","fileName","cleanupDomListeners","clear","event","oldValue","removeEventListener","node","values","axis","detachAxis","filter","a","linkedTo","concat","attachAxis","axesChanged","group","seriesRoot","removeAllSeries","addSeries","scheduleLayout","scheduleData","dataPending","before","allSeries","canAdd","beforeIndex","splice","append","initSeries","seriesChanged","onSeriesNodeClick","freeSeries","addSeriesAfter","after","afterIndex","unshift","removeSeries","index","assignSeriesToAxes","axes","axisName","direction","boundSeries","assignAxesToSeries","force","directionToAxesMap","directionAxes","directions","findMatchingAxis","getKeys","directionKeys","axisKeys","keys","j","requestAnimationFrame","cancelAnimationFrame","processData","generateNodeData","getLabelData","seriesRect","labels","x","y","map","l","legendData","showInLegend","listSeriesItems","formatter","datum","text","itemId","positionCaptions","subtitle","titleVisible","subtitleVisible","spacing","paddingTop","titleBBox","computeBBox","subtitleBBox","floor","positionLegend","legendGroup","legendSpacing","translationX","translationY","position","bottom","right","chartElement","getSeriesRect","pickSeriesNode","containsPoint","pickGroup","pickNode","pickClosestSeriesNodeDatum","getDistance","p1","p2","sqrt","pow","minDistance","Infinity","closestDatum","_loop_1","hitPoint","transformPoint","getNodeData","point","distance","handleLegendMouseMove","handleTooltip","tooltipTracking","offsetX","offsetY","pick","nodeDatum","onSeriesDatumPick","hideTooltip","inverseTransformPoint","canvasRect","pageXOffset","checkSeriesNodeClick","checkLegendClick","event_1","fireNodeClickEvent","getDatumForPoint","id_1","toggleSeriesItem","highlightStyle","undim","dehighlight","id_2","itemId_1","series_1","highlight","dim","highlightDatum","getTooltipHtml","highlightedDatum","cursor","onHighlightChange"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Scene } from \"../scene/scene\";\nimport { Group } from \"../scene/group\";\nimport { Padding } from \"../util/padding\";\nimport { Shape } from \"../scene/shape/shape\";\nimport { Rect } from \"../scene/shape/rect\";\nimport { Legend } from \"./legend\";\nimport { BBox } from \"../scene/bbox\";\nimport { find } from \"../util/array\";\nimport { SizeMonitor } from \"../util/sizeMonitor\";\nimport { Observable, reactive } from \"../util/observable\";\nimport { createId } from \"../util/id\";\nimport { placeLabels } from \"../util/labelPlacement\";\nvar defaultTooltipCss = \"\\n.ag-chart-tooltip {\\n    display: table;\\n    position: absolute;\\n    user-select: none;\\n    pointer-events: none;\\n    white-space: nowrap;\\n    z-index: 99999;\\n    font: 12px Verdana, sans-serif;\\n    color: black;\\n    background: rgb(244, 244, 244);\\n    border-radius: 5px;\\n    box-shadow: 0 0 1px rgba(3, 3, 3, 0.7), 0.5vh 0.5vh 1vh rgba(3, 3, 3, 0.25);\\n}\\n\\n.ag-chart-tooltip-hidden {\\n    top: -10000px !important;\\n}\\n\\n.ag-chart-tooltip-title {\\n    font-weight: bold;\\n    padding: 7px;\\n    border-top-left-radius: 5px;\\n    border-top-right-radius: 5px;\\n    color: white;\\n    background-color: #888888;\\n    border-top-left-radius: 5px;\\n    border-top-right-radius: 5px;\\n}\\n\\n.ag-chart-tooltip-content {\\n    padding: 7px;\\n    line-height: 1.7em;\\n    border-bottom-left-radius: 5px;\\n    border-bottom-right-radius: 5px;\\n    overflow: hidden;\\n}\\n\\n.ag-chart-tooltip-content:empty {\\n    padding: 0;\\n    height: 7px;\\n}\\n\\n.ag-chart-tooltip-arrow::before {\\n    content: \\\"\\\";\\n\\n    position: absolute;\\n    top: 100%;\\n    left: 50%;\\n    transform: translateX(-50%);\\n\\n    border: 6px solid #989898;\\n\\n    border-left-color: transparent;\\n    border-right-color: transparent;\\n    border-top-color: #989898;\\n    border-bottom-color: transparent;\\n\\n    width: 0;\\n    height: 0;\\n\\n    margin: 0 auto;\\n}\\n\\n.ag-chart-tooltip-arrow::after {\\n    content: \\\"\\\";\\n\\n    position: absolute;\\n    top: 100%;\\n    left: 50%;\\n    transform: translateX(-50%);\\n\\n    border: 5px solid black;\\n\\n    border-left-color: transparent;\\n    border-right-color: transparent;\\n    border-top-color: rgb(244, 244, 244);\\n    border-bottom-color: transparent;\\n\\n    width: 0;\\n    height: 0;\\n\\n    margin: 0 auto;\\n}\\n\\n.ag-chart-wrapper {\\n    box-sizing: border-box;\\n    overflow: hidden;\\n}\\n\";\nexport function toTooltipHtml(input, defaults) {\n    if (typeof input === 'string') {\n        return input;\n    }\n    defaults = defaults || {};\n    var _a = input.content, content = _a === void 0 ? defaults.content || '' : _a, _b = input.title, title = _b === void 0 ? defaults.title || undefined : _b, _c = input.color, color = _c === void 0 ? defaults.color || 'white' : _c, _d = input.backgroundColor, backgroundColor = _d === void 0 ? defaults.backgroundColor || '#888' : _d;\n    var titleHtml = title ? \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-title\\\"\\n        style=\\\"color: \" + color + \"; background-color: \" + backgroundColor + \"\\\">\" + title + \"</div>\" : '';\n    return titleHtml + \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-content\\\">\" + content + \"</div>\";\n}\nvar ChartTooltip = /** @class */ (function (_super) {\n    __extends(ChartTooltip, _super);\n    function ChartTooltip(chart) {\n        var _this = _super.call(this) || this;\n        _this.element = document.createElement('div');\n        _this.enabled = true;\n        _this.class = Chart.defaultTooltipClass;\n        _this.delay = 0;\n        /**\n         * If `true`, the tooltip will be shown for the marker closest to the mouse cursor.\n         * Only has effect on series with markers.\n         */\n        _this.tracking = true;\n        _this.showTimeout = 0;\n        _this.constrained = false;\n        _this.chart = chart;\n        _this.class = '';\n        var tooltipRoot = document.body;\n        tooltipRoot.appendChild(_this.element);\n        // Detect when the chart becomes invisible and hide the tooltip as well.\n        if (window.IntersectionObserver) {\n            var target_1 = _this.chart.scene.canvas.element;\n            var observer = new IntersectionObserver(function (entries) {\n                for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n                    var entry = entries_1[_i];\n                    if (entry.target === target_1 && entry.intersectionRatio === 0) {\n                        _this.toggle(false);\n                    }\n                }\n            }, { root: tooltipRoot });\n            observer.observe(target_1);\n            _this.observer = observer;\n        }\n        return _this;\n    }\n    ChartTooltip.prototype.isVisible = function () {\n        var element = this.element;\n        if (element.classList) { // if not IE11\n            return !element.classList.contains(Chart.defaultTooltipClass + '-hidden');\n        }\n        // IE11 part.\n        var classes = element.getAttribute('class');\n        if (classes) {\n            return classes.split(' ').indexOf(Chart.defaultTooltipClass + '-hidden') < 0;\n        }\n        return false;\n    };\n    ChartTooltip.prototype.updateClass = function (visible, constrained) {\n        var classList = [Chart.defaultTooltipClass, this.class];\n        if (visible !== true) {\n            classList.push(Chart.defaultTooltipClass + \"-hidden\");\n        }\n        if (constrained !== true) {\n            classList.push(Chart.defaultTooltipClass + \"-arrow\");\n        }\n        this.element.setAttribute('class', classList.join(' '));\n    };\n    /**\n     * Shows tooltip at the given event's coordinates.\n     * If the `html` parameter is missing, moves the existing tooltip to the new position.\n     */\n    ChartTooltip.prototype.show = function (meta, html, instantly) {\n        var _this = this;\n        if (instantly === void 0) { instantly = false; }\n        var el = this.element;\n        if (html !== undefined) {\n            el.innerHTML = html;\n        }\n        else if (!el.innerHTML) {\n            return;\n        }\n        var left = meta.pageX - el.clientWidth / 2;\n        var top = meta.pageY - el.clientHeight - 8;\n        this.constrained = false;\n        if (this.chart.container) {\n            var tooltipRect = el.getBoundingClientRect();\n            var minLeft = 0;\n            var maxLeft = window.innerWidth - tooltipRect.width;\n            if (left < minLeft) {\n                left = minLeft;\n                this.updateClass(true, this.constrained = true);\n            }\n            else if (left > maxLeft) {\n                left = maxLeft;\n                this.updateClass(true, this.constrained = true);\n            }\n            if (top < window.pageYOffset) {\n                top = meta.pageY + 20;\n                this.updateClass(true, this.constrained = true);\n            }\n        }\n        el.style.left = Math.round(left) + \"px\";\n        el.style.top = Math.round(top) + \"px\";\n        if (this.delay > 0 && !instantly) {\n            this.toggle(false);\n            this.showTimeout = window.setTimeout(function () {\n                _this.toggle(true);\n            }, this.delay);\n            return;\n        }\n        this.toggle(true);\n    };\n    ChartTooltip.prototype.toggle = function (visible) {\n        if (!visible) {\n            window.clearTimeout(this.showTimeout);\n            if (this.chart.lastPick && !this.delay) {\n                this.chart.dehighlightDatum();\n                this.chart.lastPick = undefined;\n            }\n        }\n        this.updateClass(visible, this.constrained);\n    };\n    ChartTooltip.prototype.destroy = function () {\n        var parentNode = this.element.parentNode;\n        if (parentNode) {\n            parentNode.removeChild(this.element);\n        }\n        if (this.observer) {\n            this.observer.unobserve(this.chart.scene.canvas.element);\n        }\n    };\n    __decorate([\n        reactive()\n    ], ChartTooltip.prototype, \"enabled\", void 0);\n    __decorate([\n        reactive()\n    ], ChartTooltip.prototype, \"class\", void 0);\n    __decorate([\n        reactive()\n    ], ChartTooltip.prototype, \"delay\", void 0);\n    __decorate([\n        reactive()\n    ], ChartTooltip.prototype, \"tracking\", void 0);\n    return ChartTooltip;\n}(Observable));\nexport { ChartTooltip };\nvar Chart = /** @class */ (function (_super) {\n    __extends(Chart, _super);\n    function Chart(document) {\n        if (document === void 0) { document = window.document; }\n        var _this = _super.call(this) || this;\n        _this.id = createId(_this);\n        _this.background = new Rect();\n        _this.legend = new Legend();\n        _this.legendAutoPadding = new Padding();\n        _this.captionAutoPadding = 0; // top padding only\n        _this._container = undefined;\n        _this._data = [];\n        _this._autoSize = false;\n        _this.padding = new Padding(20);\n        _this._axes = [];\n        _this._series = [];\n        _this._axesChanged = false;\n        _this._seriesChanged = false;\n        _this.layoutCallbackId = 0;\n        _this._performLayout = function () {\n            _this.layoutCallbackId = 0;\n            _this.background.width = _this.width;\n            _this.background.height = _this.height;\n            _this.performLayout();\n            if (!_this.layoutPending) {\n                _this.fireEvent({ type: 'layoutDone' });\n            }\n        };\n        _this.dataCallbackId = 0;\n        _this.nodeData = new Map();\n        _this.legendBBox = new BBox(0, 0, 0, 0);\n        _this._onMouseDown = _this.onMouseDown.bind(_this);\n        _this._onMouseMove = _this.onMouseMove.bind(_this);\n        _this._onMouseUp = _this.onMouseUp.bind(_this);\n        _this._onMouseOut = _this.onMouseOut.bind(_this);\n        _this._onClick = _this.onClick.bind(_this);\n        _this.pointerInsideLegend = false;\n        var root = new Group();\n        var background = _this.background;\n        background.fill = 'white';\n        root.appendChild(background);\n        var element = _this._element = document.createElement('div');\n        element.setAttribute('class', 'ag-chart-wrapper');\n        var scene = new Scene(document);\n        _this.scene = scene;\n        scene.root = root;\n        scene.container = element;\n        _this.autoSize = true;\n        var legend = _this.legend;\n        legend.addEventListener('layoutChange', _this.onLayoutChange, _this);\n        legend.item.label.addPropertyListener('formatter', _this.updateLegend, _this);\n        legend.addPropertyListener('position', _this.onLegendPositionChange, _this);\n        _this.tooltip = new ChartTooltip(_this);\n        _this.tooltip.addPropertyListener('class', function () { return _this.tooltip.toggle(); });\n        if (Chart.tooltipDocuments.indexOf(document) < 0) {\n            var styleElement = document.createElement('style');\n            styleElement.innerHTML = defaultTooltipCss;\n            // Make sure the default tooltip style goes before other styles so it can be overridden.\n            document.head.insertBefore(styleElement, document.head.querySelector('style'));\n            Chart.tooltipDocuments.push(document);\n        }\n        _this.setupDomListeners(scene.canvas.element);\n        _this.addPropertyListener('title', _this.onCaptionChange);\n        _this.addPropertyListener('subtitle', _this.onCaptionChange);\n        _this.addEventListener('layoutChange', function () { return _this.layoutPending = true; });\n        return _this;\n    }\n    Object.defineProperty(Chart.prototype, \"container\", {\n        get: function () {\n            return this._container;\n        },\n        set: function (value) {\n            if (this._container !== value) {\n                var parentNode = this.element.parentNode;\n                if (parentNode != null) {\n                    parentNode.removeChild(this.element);\n                }\n                if (value) {\n                    value.appendChild(this.element);\n                }\n                this._container = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"data\", {\n        get: function () {\n            return this._data;\n        },\n        set: function (data) {\n            this._data = data;\n            this.series.forEach(function (series) { return series.data = data; });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"width\", {\n        get: function () {\n            return this.scene.width;\n        },\n        set: function (value) {\n            this.autoSize = false;\n            if (this.width !== value) {\n                this.scene.resize(value, this.height);\n                this.fireEvent({ type: 'layoutChange' });\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"height\", {\n        get: function () {\n            return this.scene.height;\n        },\n        set: function (value) {\n            this.autoSize = false;\n            if (this.height !== value) {\n                this.scene.resize(this.width, value);\n                this.fireEvent({ type: 'layoutChange' });\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"autoSize\", {\n        get: function () {\n            return this._autoSize;\n        },\n        set: function (value) {\n            if (this._autoSize !== value) {\n                this._autoSize = value;\n                var style = this.element.style;\n                if (value) {\n                    var chart_1 = this; // capture `this` for IE11\n                    SizeMonitor.observe(this.element, function (size) {\n                        if (size.width !== chart_1.width || size.height !== chart_1.height) {\n                            chart_1.scene.resize(size.width, size.height);\n                            chart_1.fireEvent({ type: 'layoutChange' });\n                        }\n                    });\n                    style.display = 'block';\n                    style.width = '100%';\n                    style.height = '100%';\n                }\n                else {\n                    SizeMonitor.unobserve(this.element);\n                    style.display = 'inline-block';\n                    style.width = 'auto';\n                    style.height = 'auto';\n                }\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.download = function (fileName) {\n        this.scene.download(fileName);\n    };\n    Chart.prototype.destroy = function () {\n        this.tooltip.destroy();\n        SizeMonitor.unobserve(this.element);\n        this.container = undefined;\n        this.cleanupDomListeners(this.scene.canvas.element);\n        this.scene.container = undefined;\n    };\n    Chart.prototype.onLayoutChange = function () {\n        this.layoutPending = true;\n    };\n    Chart.prototype.onLegendPositionChange = function () {\n        this.legendAutoPadding.clear();\n        this.layoutPending = true;\n    };\n    Chart.prototype.onCaptionChange = function (event) {\n        var value = event.value, oldValue = event.oldValue;\n        if (oldValue) {\n            oldValue.removeEventListener('change', this.onLayoutChange, this);\n            this.scene.root.removeChild(oldValue.node);\n        }\n        if (value) {\n            value.addEventListener('change', this.onLayoutChange, this);\n            this.scene.root.appendChild(value.node);\n        }\n    };\n    Object.defineProperty(Chart.prototype, \"element\", {\n        get: function () {\n            return this._element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"axes\", {\n        get: function () {\n            return this._axes;\n        },\n        set: function (values) {\n            var _this = this;\n            this._axes.forEach(function (axis) { return _this.detachAxis(axis); });\n            // make linked axes go after the regular ones (simulates stable sort by `linkedTo` property)\n            this._axes = values.filter(function (a) { return !a.linkedTo; }).concat(values.filter(function (a) { return a.linkedTo; }));\n            this._axes.forEach(function (axis) { return _this.attachAxis(axis); });\n            this.axesChanged = true;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.attachAxis = function (axis) {\n        this.scene.root.insertBefore(axis.group, this.seriesRoot);\n    };\n    Chart.prototype.detachAxis = function (axis) {\n        this.scene.root.removeChild(axis.group);\n    };\n    Object.defineProperty(Chart.prototype, \"series\", {\n        get: function () {\n            return this._series;\n        },\n        set: function (values) {\n            var _this = this;\n            this.removeAllSeries();\n            values.forEach(function (series) { return _this.addSeries(series); });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.scheduleLayout = function () {\n        this.layoutPending = true;\n    };\n    Chart.prototype.scheduleData = function () {\n        // To prevent the chart from thinking the cursor is over the same node\n        // after a change to data (the nodes are reused on data changes).\n        this.dehighlightDatum();\n        this.dataPending = true;\n    };\n    Chart.prototype.addSeries = function (series, before) {\n        var _a = this, allSeries = _a.series, seriesRoot = _a.seriesRoot;\n        var canAdd = allSeries.indexOf(series) < 0;\n        if (canAdd) {\n            var beforeIndex = before ? allSeries.indexOf(before) : -1;\n            if (beforeIndex >= 0) {\n                allSeries.splice(beforeIndex, 0, series);\n                seriesRoot.insertBefore(series.group, before.group);\n            }\n            else {\n                allSeries.push(series);\n                seriesRoot.append(series.group);\n            }\n            this.initSeries(series);\n            this.seriesChanged = true;\n            this.axesChanged = true;\n            return true;\n        }\n        return false;\n    };\n    Chart.prototype.initSeries = function (series) {\n        series.chart = this;\n        if (!series.data) {\n            series.data = this.data;\n        }\n        series.addEventListener('layoutChange', this.scheduleLayout, this);\n        series.addEventListener('dataChange', this.scheduleData, this);\n        series.addEventListener('legendChange', this.updateLegend, this);\n        series.addEventListener('nodeClick', this.onSeriesNodeClick, this);\n    };\n    Chart.prototype.freeSeries = function (series) {\n        series.chart = undefined;\n        series.removeEventListener('layoutChange', this.scheduleLayout, this);\n        series.removeEventListener('dataChange', this.scheduleData, this);\n        series.removeEventListener('legendChange', this.updateLegend, this);\n        series.removeEventListener('nodeClick', this.onSeriesNodeClick, this);\n    };\n    Chart.prototype.addSeriesAfter = function (series, after) {\n        var _a = this, allSeries = _a.series, seriesRoot = _a.seriesRoot;\n        var canAdd = allSeries.indexOf(series) < 0;\n        if (canAdd) {\n            var afterIndex = after ? this.series.indexOf(after) : -1;\n            if (afterIndex >= 0) {\n                if (afterIndex + 1 < allSeries.length) {\n                    seriesRoot.insertBefore(series.group, allSeries[afterIndex + 1].group);\n                }\n                else {\n                    seriesRoot.append(series.group);\n                }\n                this.initSeries(series);\n                allSeries.splice(afterIndex + 1, 0, series);\n            }\n            else {\n                if (allSeries.length > 0) {\n                    seriesRoot.insertBefore(series.group, allSeries[0].group);\n                }\n                else {\n                    seriesRoot.append(series.group);\n                }\n                this.initSeries(series);\n                allSeries.unshift(series);\n            }\n            this.seriesChanged = true;\n            this.axesChanged = true;\n        }\n        return false;\n    };\n    Chart.prototype.removeSeries = function (series) {\n        var index = this.series.indexOf(series);\n        if (index >= 0) {\n            this.series.splice(index, 1);\n            this.freeSeries(series);\n            this.seriesRoot.removeChild(series.group);\n            this.seriesChanged = true;\n            return true;\n        }\n        return false;\n    };\n    Chart.prototype.removeAllSeries = function () {\n        var _this = this;\n        this.series.forEach(function (series) {\n            _this.freeSeries(series);\n            _this.seriesRoot.removeChild(series.group);\n        });\n        this._series = []; // using `_series` instead of `series` to prevent infinite recursion\n        this.seriesChanged = true;\n    };\n    Chart.prototype.assignSeriesToAxes = function () {\n        var _this = this;\n        this.axes.forEach(function (axis) {\n            var axisName = axis.direction + 'Axis';\n            var boundSeries = [];\n            _this.series.forEach(function (series) {\n                if (series[axisName] === axis) {\n                    boundSeries.push(series);\n                }\n            });\n            axis.boundSeries = boundSeries;\n        });\n        this.seriesChanged = false;\n    };\n    Chart.prototype.assignAxesToSeries = function (force) {\n        var _this = this;\n        if (force === void 0) { force = false; }\n        // This method has to run before `assignSeriesToAxes`.\n        var directionToAxesMap = {};\n        this.axes.forEach(function (axis) {\n            var direction = axis.direction;\n            var directionAxes = directionToAxesMap[direction] || (directionToAxesMap[direction] = []);\n            directionAxes.push(axis);\n        });\n        this.series.forEach(function (series) {\n            series.directions.forEach(function (direction) {\n                var axisName = direction + 'Axis';\n                if (!series[axisName] || force) {\n                    var directionAxes = directionToAxesMap[direction];\n                    if (directionAxes) {\n                        var axis = _this.findMatchingAxis(directionAxes, series.getKeys(direction));\n                        if (axis) {\n                            series[axisName] = axis;\n                        }\n                    }\n                }\n            });\n        });\n        this.axesChanged = false;\n    };\n    Chart.prototype.findMatchingAxis = function (directionAxes, directionKeys) {\n        for (var i = 0; i < directionAxes.length; i++) {\n            var axis = directionAxes[i];\n            var axisKeys = axis.keys;\n            if (!axisKeys.length) {\n                return axis;\n            }\n            else if (directionKeys) {\n                for (var j = 0; j < directionKeys.length; j++) {\n                    if (axisKeys.indexOf(directionKeys[j]) >= 0) {\n                        return axis;\n                    }\n                }\n            }\n        }\n    };\n    Object.defineProperty(Chart.prototype, \"axesChanged\", {\n        get: function () {\n            return this._axesChanged;\n        },\n        set: function (value) {\n            this._axesChanged = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"seriesChanged\", {\n        get: function () {\n            return this._seriesChanged;\n        },\n        set: function (value) {\n            this._seriesChanged = value;\n            if (value) {\n                this.dataPending = true;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"layoutPending\", {\n        /**\n         * Only `true` while we are waiting for the layout to start.\n         * This will be `false` if the layout has already started and is ongoing.\n         */\n        get: function () {\n            return !!this.layoutCallbackId;\n        },\n        set: function (value) {\n            if (value) {\n                if (!(this.layoutCallbackId || this.dataPending)) {\n                    this.layoutCallbackId = requestAnimationFrame(this._performLayout);\n                }\n            }\n            else if (this.layoutCallbackId) {\n                cancelAnimationFrame(this.layoutCallbackId);\n                this.layoutCallbackId = 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"dataPending\", {\n        get: function () {\n            return !!this.dataCallbackId;\n        },\n        set: function (value) {\n            var _this = this;\n            if (this.dataCallbackId) {\n                clearTimeout(this.dataCallbackId);\n                this.dataCallbackId = 0;\n            }\n            if (value) {\n                this.dataCallbackId = window.setTimeout(function () {\n                    _this.dataPending = false;\n                    _this.processData();\n                }, 0);\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.processData = function () {\n        this.layoutPending = false;\n        if (this.axesChanged) {\n            this.assignAxesToSeries(true);\n            this.assignSeriesToAxes();\n        }\n        if (this.seriesChanged) {\n            this.assignSeriesToAxes();\n        }\n        this.series.forEach(function (s) { return s.processData(); });\n        this.updateLegend();\n        this.layoutPending = true;\n    };\n    Chart.prototype.generateNodeData = function () {\n        var _this = this;\n        this.nodeData.clear();\n        this.series.forEach(function (s) {\n            var data = s.visible ? s.generateNodeData() : [];\n            _this.nodeData.set(s, data);\n        });\n    };\n    Chart.prototype.placeLabels = function () {\n        var series = [];\n        var data = [];\n        this.nodeData.forEach(function (d, s) {\n            if (s.visible && s.label.enabled) {\n                series.push(s);\n                data.push(s.getLabelData());\n            }\n        });\n        var seriesRect = this.seriesRect;\n        var labels = seriesRect\n            ? placeLabels(data, { x: 0, y: 0, width: seriesRect.width, height: seriesRect.height })\n            : [];\n        return new Map(labels.map(function (l, i) { return [series[i], l]; }));\n    };\n    Chart.prototype.updateLegend = function () {\n        var legendData = [];\n        this.series.filter(function (s) { return s.showInLegend; }).forEach(function (series) { return series.listSeriesItems(legendData); });\n        var formatter = this.legend.item.label.formatter;\n        if (formatter) {\n            legendData.forEach(function (datum) { return datum.label.text = formatter({\n                id: datum.id,\n                itemId: datum.itemId,\n                value: datum.label.text\n            }); });\n        }\n        this.legend.data = legendData;\n    };\n    Chart.prototype.positionCaptions = function () {\n        var _a = this, title = _a.title, subtitle = _a.subtitle;\n        var titleVisible = false;\n        var subtitleVisible = false;\n        var spacing = 10;\n        var paddingTop = spacing;\n        if (title && title.enabled) {\n            title.node.x = this.width / 2;\n            title.node.y = paddingTop;\n            titleVisible = true;\n            var titleBBox = title.node.computeBBox(); // make sure to set node's x/y, then computeBBox\n            if (titleBBox) {\n                paddingTop = titleBBox.y + titleBBox.height;\n            }\n            if (subtitle && subtitle.enabled) {\n                subtitle.node.x = this.width / 2;\n                subtitle.node.y = paddingTop + spacing;\n                subtitleVisible = true;\n                var subtitleBBox = subtitle.node.computeBBox();\n                if (subtitleBBox) {\n                    paddingTop = subtitleBBox.y + subtitleBBox.height;\n                }\n            }\n        }\n        if (title) {\n            title.node.visible = titleVisible;\n        }\n        if (subtitle) {\n            subtitle.node.visible = subtitleVisible;\n        }\n        this.captionAutoPadding = Math.floor(paddingTop);\n    };\n    Chart.prototype.positionLegend = function () {\n        if (!this.legend.enabled || !this.legend.data.length) {\n            return;\n        }\n        var _a = this, legend = _a.legend, captionAutoPadding = _a.captionAutoPadding, legendAutoPadding = _a.legendAutoPadding;\n        var width = this.width;\n        var height = this.height - captionAutoPadding;\n        var legendGroup = legend.group;\n        var legendSpacing = legend.spacing;\n        var translationX = 0;\n        var translationY = 0;\n        var legendBBox;\n        switch (legend.position) {\n            case 'bottom':\n                legend.performLayout(width - legendSpacing * 2, 0);\n                legendBBox = legendGroup.computeBBox();\n                translationX = (width - legendBBox.width) / 2 - legendBBox.x;\n                translationY = captionAutoPadding + height - legendBBox.height - legendBBox.y - legendSpacing;\n                legendAutoPadding.bottom = legendBBox.height;\n                break;\n            case 'top':\n                legend.performLayout(width - legendSpacing * 2, 0);\n                legendBBox = legendGroup.computeBBox();\n                translationX = (width - legendBBox.width) / 2 - legendBBox.x;\n                translationY = captionAutoPadding + legendSpacing - legendBBox.y;\n                legendAutoPadding.top = legendBBox.height;\n                break;\n            case 'left':\n                legend.performLayout(0, height - legendSpacing * 2);\n                legendBBox = legendGroup.computeBBox();\n                translationX = legendSpacing - legendBBox.x;\n                translationY = captionAutoPadding + (height - legendBBox.height) / 2 - legendBBox.y;\n                legendAutoPadding.left = legendBBox.width;\n                break;\n            default: // case 'right':\n                legend.performLayout(0, height - legendSpacing * 2);\n                legendBBox = legendGroup.computeBBox();\n                translationX = width - legendBBox.width - legendBBox.x - legendSpacing;\n                translationY = captionAutoPadding + (height - legendBBox.height) / 2 - legendBBox.y;\n                legendAutoPadding.right = legendBBox.width;\n                break;\n        }\n        // Round off for pixel grid alignment to work properly.\n        legendGroup.translationX = Math.floor(translationX + legendGroup.translationX);\n        legendGroup.translationY = Math.floor(translationY + legendGroup.translationY);\n        this.legendBBox = legendGroup.computeBBox();\n    };\n    Chart.prototype.setupDomListeners = function (chartElement) {\n        chartElement.addEventListener('mousedown', this._onMouseDown);\n        chartElement.addEventListener('mousemove', this._onMouseMove);\n        chartElement.addEventListener('mouseup', this._onMouseUp);\n        chartElement.addEventListener('mouseout', this._onMouseOut);\n        chartElement.addEventListener('click', this._onClick);\n    };\n    Chart.prototype.cleanupDomListeners = function (chartElement) {\n        chartElement.removeEventListener('mousedown', this._onMouseDown);\n        chartElement.removeEventListener('mousemove', this._onMouseMove);\n        chartElement.removeEventListener('mouseup', this._onMouseUp);\n        chartElement.removeEventListener('mouseout', this._onMouseOut);\n        chartElement.removeEventListener('click', this._onClick);\n    };\n    Chart.prototype.getSeriesRect = function () {\n        return this.seriesRect;\n    };\n    // x/y are local canvas coordinates in CSS pixels, not actual pixels\n    Chart.prototype.pickSeriesNode = function (x, y) {\n        if (!(this.seriesRect && this.seriesRect.containsPoint(x, y))) {\n            return undefined;\n        }\n        var allSeries = this.series;\n        var node = undefined;\n        for (var i = allSeries.length - 1; i >= 0; i--) {\n            var series = allSeries[i];\n            if (!series.visible) {\n                continue;\n            }\n            node = series.pickGroup.pickNode(x, y);\n            if (node) {\n                return {\n                    series: series,\n                    node: node\n                };\n            }\n        }\n    };\n    // Provided x/y are in canvas coordinates.\n    Chart.prototype.pickClosestSeriesNodeDatum = function (x, y) {\n        if (!this.seriesRect || !this.seriesRect.containsPoint(x, y)) {\n            return undefined;\n        }\n        var allSeries = this.series;\n        function getDistance(p1, p2) {\n            return Math.sqrt(Math.pow((p1.x - p2.x), 2) + Math.pow((p1.y - p2.y), 2));\n        }\n        var minDistance = Infinity;\n        var closestDatum;\n        var _loop_1 = function (i) {\n            var series = allSeries[i];\n            if (!series.visible) {\n                return \"continue\";\n            }\n            var hitPoint = series.group.transformPoint(x, y);\n            series.getNodeData().forEach(function (datum) {\n                if (!datum.point) {\n                    return;\n                }\n                var distance = getDistance(hitPoint, datum.point);\n                if (distance < minDistance) {\n                    minDistance = distance;\n                    closestDatum = datum;\n                }\n            });\n        };\n        for (var i = allSeries.length - 1; i >= 0; i--) {\n            _loop_1(i);\n        }\n        if (closestDatum) {\n            return closestDatum;\n        }\n    };\n    Chart.prototype.onMouseMove = function (event) {\n        this.handleLegendMouseMove(event);\n        if (this.tooltip.enabled) {\n            if (this.tooltip.delay > 0) {\n                this.tooltip.toggle(false);\n            }\n            this.handleTooltip(event);\n        }\n    };\n    Chart.prototype.handleTooltip = function (event) {\n        var _a = this, lastPick = _a.lastPick, tooltipTracking = _a.tooltip.tracking;\n        var offsetX = event.offsetX, offsetY = event.offsetY;\n        var pick = this.pickSeriesNode(offsetX, offsetY);\n        var nodeDatum;\n        if (pick && pick.node instanceof Shape) {\n            var node = pick.node;\n            nodeDatum = node.datum;\n            if (lastPick && lastPick.datum === nodeDatum) {\n                lastPick.node = node;\n                lastPick.event = event;\n            }\n            // Marker nodes will have the `point` info in their datums.\n            // Highlight if not a marker node or, if not in the tracking mode, highlight markers too.\n            if ((!node.datum.point || !tooltipTracking)) {\n                if (!lastPick // cursor moved from empty space to a node\n                    || lastPick.node !== node) { // cursor moved from one node to another\n                    this.onSeriesDatumPick(event, node.datum, node, event);\n                }\n                else if (pick.series.tooltip.enabled) { // cursor moved within the same node\n                    this.tooltip.show(event);\n                }\n                // A non-marker node (takes precedence over marker nodes) was highlighted.\n                // Or we are not in the tracking mode.\n                // Either way, we are done at this point.\n                return;\n            }\n        }\n        var hideTooltip = false;\n        // In tracking mode a tooltip is shown for the closest rendered datum.\n        // This makes it easier to show tooltips when markers are small and/or plentiful\n        // and also gives the ability to show tooltips even when the series were configured\n        // to not render markers.\n        if (tooltipTracking) {\n            var closestDatum = this.pickClosestSeriesNodeDatum(offsetX, offsetY);\n            if (closestDatum && closestDatum.point) {\n                var _b = closestDatum.point, x = _b.x, y = _b.y;\n                var canvas = this.scene.canvas;\n                var point = closestDatum.series.group.inverseTransformPoint(x, y);\n                var canvasRect = canvas.element.getBoundingClientRect();\n                this.onSeriesDatumPick({\n                    pageX: Math.round(canvasRect.left + window.pageXOffset + point.x),\n                    pageY: Math.round(canvasRect.top + window.pageYOffset + point.y)\n                }, closestDatum, nodeDatum === closestDatum && pick ? pick.node : undefined, event);\n            }\n            else {\n                hideTooltip = true;\n            }\n        }\n        if (lastPick && (hideTooltip || !tooltipTracking)) {\n            // Cursor moved from a non-marker node to empty space.\n            this.dehighlightDatum();\n            this.tooltip.toggle(false);\n            this.lastPick = undefined;\n        }\n    };\n    Chart.prototype.onMouseDown = function (event) { };\n    Chart.prototype.onMouseUp = function (event) { };\n    Chart.prototype.onMouseOut = function (event) {\n        this.tooltip.toggle(false);\n    };\n    Chart.prototype.onClick = function (event) {\n        if (this.checkSeriesNodeClick()) {\n            return;\n        }\n        if (this.checkLegendClick(event)) {\n            return;\n        }\n        this.fireEvent({\n            type: 'click',\n            event: event\n        });\n    };\n    Chart.prototype.checkSeriesNodeClick = function () {\n        var lastPick = this.lastPick;\n        if (lastPick && lastPick.event && lastPick.node) {\n            var event_1 = lastPick.event, datum = lastPick.datum;\n            datum.series.fireNodeClickEvent(event_1, datum);\n            return true;\n        }\n        return false;\n    };\n    Chart.prototype.onSeriesNodeClick = function (event) {\n        this.fireEvent(__assign(__assign({}, event), { type: 'seriesNodeClick' }));\n    };\n    Chart.prototype.checkLegendClick = function (event) {\n        var datum = this.legend.getDatumForPoint(event.offsetX, event.offsetY);\n        if (datum) {\n            var id_1 = datum.id, itemId = datum.itemId, enabled = datum.enabled;\n            var series = find(this.series, function (series) { return series.id === id_1; });\n            if (series) {\n                series.toggleSeriesItem(itemId, !enabled);\n                if (enabled) {\n                    this.tooltip.toggle(false);\n                }\n                this.legend.fireEvent({\n                    type: 'click',\n                    event: event,\n                    itemId: itemId,\n                    enabled: !enabled\n                });\n                return true;\n            }\n        }\n        return false;\n    };\n    Chart.prototype.handleLegendMouseMove = function (event) {\n        if (!this.legend.enabled) {\n            return;\n        }\n        var offsetX = event.offsetX, offsetY = event.offsetY;\n        var datum = this.legend.getDatumForPoint(offsetX, offsetY);\n        var pointerInsideLegend = this.legendBBox.containsPoint(offsetX, offsetY);\n        if (pointerInsideLegend) {\n            if (!this.pointerInsideLegend) {\n                this.pointerInsideLegend = true;\n            }\n        }\n        else if (this.pointerInsideLegend) {\n            this.pointerInsideLegend = false;\n            // Undim all series only if the pointer was inside legend is now leaving it.\n            this.series.forEach(function (series) {\n                if (series.highlightStyle.series.enabled) {\n                    series.undim();\n                    series.dehighlight();\n                }\n            });\n            return;\n        }\n        if (datum) {\n            var id_2 = datum.id, itemId_1 = datum.itemId;\n            var series_1 = find(this.series, function (series) { return series.id === id_2; });\n            if (series_1 && series_1.highlightStyle.series.enabled) {\n                this.series.forEach(function (s) { return s === series_1 ? s.highlight(itemId_1) : s.dim(); });\n            }\n        }\n    };\n    Chart.prototype.onSeriesDatumPick = function (meta, datum, node, event) {\n        if (this.lastPick) {\n            this.dehighlightDatum();\n        }\n        this.lastPick = {\n            datum: datum,\n            node: node,\n            event: event\n        };\n        this.highlightDatum(datum, node);\n        var html = datum.series.tooltip.enabled && datum.series.getTooltipHtml(datum);\n        if (html) {\n            this.tooltip.show(meta, html);\n        }\n    };\n    Chart.prototype.highlightDatum = function (datum, node) {\n        var style = this.scene.canvas.element.style;\n        this.highlightedDatum = datum;\n        this.series.forEach(function (s) {\n            if (node) {\n                style.cursor = s.cursor;\n            }\n            if (s.highlightStyle.series.enabled) {\n                if (s === datum.series) {\n                    s.highlight(datum.itemId);\n                }\n                else {\n                    s.dim();\n                }\n            }\n            s.onHighlightChange();\n        });\n    };\n    Chart.prototype.dehighlightDatum = function () {\n        if (this.highlightedDatum) {\n            this.scene.canvas.element.style.cursor = 'default';\n            this.highlightedDatum = undefined;\n            this.series.forEach(function (s) {\n                s.onHighlightChange();\n                if (s.highlightStyle.series.enabled) {\n                    s.undim();\n                    s.dehighlight();\n                }\n            });\n        }\n    };\n    Chart.defaultTooltipClass = 'ag-chart-tooltip';\n    Chart.tooltipDocuments = [];\n    __decorate([\n        reactive('layoutChange')\n    ], Chart.prototype, \"padding\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], Chart.prototype, \"title\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], Chart.prototype, \"subtitle\", void 0);\n    return Chart;\n}(Observable));\nexport { Chart };\n"]},"metadata":{},"sourceType":"module"}