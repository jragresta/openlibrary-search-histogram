{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Selection } from \"../../../scene/selection\";\nimport { SeriesTooltip } from \"../series\";\nimport { finiteExtent } from \"../../../util/array\";\nimport { LinearScale } from \"../../../scale/linearScale\";\nimport { reactive } from \"../../../util/observable\";\nimport { CartesianSeries, CartesianSeriesMarker } from \"./cartesianSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { getMarker } from \"../../marker/util\";\nimport { toTooltipHtml } from \"../../chart\";\nimport ContinuousScale from \"../../../scale/continuousScale\";\nimport { sanitizeHtml } from \"../../../util/sanitize\";\nimport { Label } from \"../../label\";\nimport { Text } from \"../../../scene/shape/text\";\nimport { HdpiCanvas } from \"../../../canvas/hdpiCanvas\";\n\nvar ScatterSeriesTooltip = function (_super) {\n  __extends(ScatterSeriesTooltip, _super);\n\n  function ScatterSeriesTooltip() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([reactive('change')], ScatterSeriesTooltip.prototype, \"renderer\", void 0);\n\n  return ScatterSeriesTooltip;\n}(SeriesTooltip);\n\nexport { ScatterSeriesTooltip };\n\nvar ScatterSeries = function (_super) {\n  __extends(ScatterSeries, _super);\n\n  function ScatterSeries() {\n    var _this = _super.call(this) || this;\n\n    _this.xDomain = [];\n    _this.yDomain = [];\n    _this.xData = [];\n    _this.yData = [];\n    _this.sizeData = [];\n    _this.sizeScale = new LinearScale();\n    _this.nodeData = [];\n    _this.markerSelection = Selection.select(_this.pickGroup).selectAll();\n    _this.labelData = [];\n    _this.labelSelection = Selection.select(_this.group).selectAll();\n    _this.marker = new CartesianSeriesMarker();\n    _this.label = new Label();\n    _this._fill = '#c16068';\n    _this._stroke = '#874349';\n    _this._strokeWidth = 2;\n    _this._fillOpacity = 1;\n    _this._strokeOpacity = 1;\n    _this.xKey = '';\n    _this.yKey = '';\n    _this.xName = '';\n    _this.yName = '';\n    _this.sizeName = 'Size';\n    _this.labelName = 'Label';\n    _this.tooltip = new ScatterSeriesTooltip();\n    var _a = _this,\n        marker = _a.marker,\n        label = _a.label;\n    marker.addPropertyListener('shape', _this.onMarkerShapeChange, _this);\n    marker.addEventListener('change', _this.update, _this);\n\n    _this.addPropertyListener('xKey', function () {\n      return _this.xData = [];\n    });\n\n    _this.addPropertyListener('yKey', function () {\n      return _this.yData = [];\n    });\n\n    _this.addPropertyListener('sizeKey', function () {\n      return _this.sizeData = [];\n    });\n\n    label.enabled = false;\n    label.addEventListener('change', _this.update, _this);\n    label.addEventListener('dataChange', _this.scheduleData, _this);\n    label.addPropertyListener('fontSize', _this.scheduleData, _this);\n    return _this;\n  }\n\n  Object.defineProperty(ScatterSeries.prototype, \"fill\", {\n    get: function get() {\n      return this._fill;\n    },\n    set: function set(value) {\n      if (this._fill !== value) {\n        this._fill = value;\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ScatterSeries.prototype, \"stroke\", {\n    get: function get() {\n      return this._stroke;\n    },\n    set: function set(value) {\n      if (this._stroke !== value) {\n        this._stroke = value;\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ScatterSeries.prototype, \"strokeWidth\", {\n    get: function get() {\n      return this._strokeWidth;\n    },\n    set: function set(value) {\n      if (this._strokeWidth !== value) {\n        this._strokeWidth = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ScatterSeries.prototype, \"fillOpacity\", {\n    get: function get() {\n      return this._fillOpacity;\n    },\n    set: function set(value) {\n      if (this._fillOpacity !== value) {\n        this._fillOpacity = value;\n        this.scheduleLayout();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ScatterSeries.prototype, \"strokeOpacity\", {\n    get: function get() {\n      return this._strokeOpacity;\n    },\n    set: function set(value) {\n      if (this._strokeOpacity !== value) {\n        this._strokeOpacity = value;\n        this.scheduleLayout();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ScatterSeries.prototype.onHighlightChange = function () {\n    this.updateMarkerNodes();\n  };\n\n  ScatterSeries.prototype.onMarkerShapeChange = function () {\n    this.markerSelection = this.markerSelection.setData([]);\n    this.markerSelection.exit.remove();\n    this.update();\n    this.fireEvent({\n      type: 'legendChange'\n    });\n  };\n\n  ScatterSeries.prototype.setColors = function (fills, strokes) {\n    this.fill = fills[0];\n    this.stroke = strokes[0];\n    this.marker.fill = fills[0];\n    this.marker.stroke = strokes[0];\n  };\n\n  ScatterSeries.prototype.processData = function () {\n    var _a = this,\n        xKey = _a.xKey,\n        yKey = _a.yKey,\n        sizeKey = _a.sizeKey,\n        labelKey = _a.labelKey,\n        xAxis = _a.xAxis,\n        yAxis = _a.yAxis,\n        marker = _a.marker,\n        label = _a.label;\n\n    var data = xKey && yKey && this.data ? this.data : [];\n    this.xData = data.map(function (d) {\n      return d[xKey];\n    });\n    this.yData = data.map(function (d) {\n      return d[yKey];\n    });\n    this.sizeData = sizeKey ? data.map(function (d) {\n      return d[sizeKey];\n    }) : [];\n    var font = label.getFont();\n    this.labelData = labelKey ? data.map(function (d) {\n      var text = String(d[labelKey]);\n      var size = HdpiCanvas.getTextSize(text, font);\n      return __assign({\n        text: text\n      }, size);\n    }) : [];\n    this.sizeScale.domain = marker.domain ? marker.domain : finiteExtent(this.sizeData) || [1, 1];\n\n    if (xAxis.scale instanceof ContinuousScale) {\n      this.xDomain = this.fixNumericExtent(finiteExtent(this.xData), 'x');\n    } else {\n      this.xDomain = this.xData;\n    }\n\n    if (yAxis.scale instanceof ContinuousScale) {\n      this.yDomain = this.fixNumericExtent(finiteExtent(this.yData), 'y');\n    } else {\n      this.yDomain = this.yData;\n    }\n\n    return true;\n  };\n\n  ScatterSeries.prototype.getDomain = function (direction) {\n    if (direction === ChartAxisDirection.X) {\n      return this.xDomain;\n    } else {\n      return this.yDomain;\n    }\n  };\n\n  ScatterSeries.prototype.getNodeData = function () {\n    return this.nodeData;\n  };\n\n  ScatterSeries.prototype.getLabelData = function () {\n    return this.nodeData;\n  };\n\n  ScatterSeries.prototype.fireNodeClickEvent = function (event, datum) {\n    this.fireEvent({\n      type: 'nodeClick',\n      event: event,\n      series: this,\n      datum: datum.seriesDatum,\n      xKey: this.xKey,\n      yKey: this.yKey,\n      sizeKey: this.sizeKey\n    });\n  };\n\n  ScatterSeries.prototype.generateNodeData = function () {\n    if (!this.data) {\n      return [];\n    }\n\n    var _a = this,\n        xAxis = _a.xAxis,\n        yAxis = _a.yAxis;\n\n    var xScale = xAxis.scale;\n    var yScale = yAxis.scale;\n    var isContinuousX = xScale instanceof ContinuousScale;\n    var isContinuousY = yScale instanceof ContinuousScale;\n    var xOffset = (xScale.bandwidth || 0) / 2;\n    var yOffset = (yScale.bandwidth || 0) / 2;\n\n    var _b = this,\n        data = _b.data,\n        xData = _b.xData,\n        yData = _b.yData,\n        sizeData = _b.sizeData,\n        sizeScale = _b.sizeScale,\n        marker = _b.marker;\n\n    var nodeData = [];\n    sizeScale.range = [marker.size, marker.maxSize];\n\n    for (var i = 0; i < xData.length; i++) {\n      var xDatum = xData[i];\n      var yDatum = yData[i];\n      var noDatum = yDatum == null || isContinuousY && (isNaN(yDatum) || !isFinite(yDatum)) || xDatum == null || isContinuousX && (isNaN(xDatum) || !isFinite(xDatum));\n\n      if (noDatum) {\n        continue;\n      }\n\n      var x = xScale.convert(xDatum) + xOffset;\n      var y = yScale.convert(yDatum) + yOffset;\n\n      if (!(xAxis.inRange(x) && yAxis.inRange(y))) {\n        continue;\n      }\n\n      nodeData.push({\n        series: this,\n        seriesDatum: data[i],\n        point: {\n          x: x,\n          y: y\n        },\n        size: sizeData.length ? sizeScale.convert(sizeData[i]) : marker.size,\n        label: this.labelData[i]\n      });\n    }\n\n    return this.nodeData = nodeData;\n  };\n\n  ScatterSeries.prototype.update = function () {\n    var _a = this,\n        visible = _a.visible,\n        chart = _a.chart,\n        xAxis = _a.xAxis,\n        yAxis = _a.yAxis;\n\n    this.group.visible = visible;\n\n    if (!visible || !chart || chart.layoutPending || chart.dataPending || !xAxis || !yAxis) {\n      return;\n    }\n\n    this.generateNodeData();\n    this.updateMarkerSelection(this.nodeData);\n    this.updateLabelSelection(this.nodeData);\n    this.updateMarkerNodes();\n    this.updateLabelNodes();\n  };\n\n  ScatterSeries.prototype.updateLabelSelection = function (nodeData) {\n    var placedLabels = this.chart && this.chart.placeLabels().get(this) || [];\n    var updateLabels = this.labelSelection.setData(placedLabels);\n    updateLabels.exit.remove();\n    var enterLabels = updateLabels.enter.append(Text);\n    this.labelSelection = updateLabels.merge(enterLabels);\n  };\n\n  ScatterSeries.prototype.updateMarkerSelection = function (nodeData) {\n    var MarkerShape = getMarker(this.marker.shape);\n    var updateMarkers = this.markerSelection.setData(nodeData);\n    updateMarkers.exit.remove();\n    var enterMarkers = updateMarkers.enter.append(MarkerShape);\n    this.markerSelection = updateMarkers.merge(enterMarkers);\n  };\n\n  ScatterSeries.prototype.updateLabelNodes = function () {\n    var label = this.label;\n    this.labelSelection.each(function (text, datum) {\n      text.text = datum.text;\n      text.fill = label.color;\n      text.x = datum.x;\n      text.y = datum.y;\n      text.fontStyle = label.fontStyle;\n      text.fontWeight = label.fontWeight;\n      text.fontSize = label.fontSize;\n      text.fontFamily = label.fontFamily;\n      text.textAlign = 'left';\n      text.textBaseline = 'top';\n    });\n  };\n\n  ScatterSeries.prototype.updateMarkerNodes = function () {\n    if (!this.chart) {\n      return;\n    }\n\n    var highlightedDatum = this.chart.highlightedDatum;\n\n    var _a = this,\n        marker = _a.marker,\n        xKey = _a.xKey,\n        yKey = _a.yKey,\n        fill = _a.fill,\n        stroke = _a.stroke,\n        strokeWidth = _a.strokeWidth,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity;\n\n    var _b = this.highlightStyle,\n        highlightFill = _b.fill,\n        highlightStroke = _b.stroke;\n    var markerStrokeWidth = marker.strokeWidth !== undefined ? marker.strokeWidth : strokeWidth;\n    var markerFormatter = marker.formatter;\n    this.markerSelection.each(function (node, datum) {\n      var highlighted = datum === highlightedDatum;\n      var markerFill = highlighted && highlightFill !== undefined ? highlightFill : marker.fill || fill;\n      var markerStroke = highlighted && highlightStroke !== undefined ? highlightStroke : marker.stroke || stroke;\n      var markerFormat = undefined;\n\n      if (markerFormatter) {\n        markerFormat = markerFormatter({\n          datum: datum.seriesDatum,\n          xKey: xKey,\n          yKey: yKey,\n          fill: markerFill,\n          stroke: markerStroke,\n          strokeWidth: markerStrokeWidth,\n          size: datum.size,\n          highlighted: highlighted\n        });\n      }\n\n      node.fill = markerFormat && markerFormat.fill || markerFill;\n      node.stroke = markerFormat && markerFormat.stroke || markerStroke;\n      node.strokeWidth = markerFormat && markerFormat.strokeWidth !== undefined ? markerFormat.strokeWidth : markerStrokeWidth;\n      node.size = markerFormat && markerFormat.size !== undefined ? markerFormat.size : datum.size;\n      node.fillOpacity = fillOpacity;\n      node.strokeOpacity = strokeOpacity;\n      node.translationX = datum.point.x;\n      node.translationY = datum.point.y;\n      node.visible = marker.enabled && node.size > 0;\n    });\n  };\n\n  ScatterSeries.prototype.getTooltipHtml = function (nodeDatum) {\n    var _a = this,\n        xKey = _a.xKey,\n        yKey = _a.yKey,\n        xAxis = _a.xAxis,\n        yAxis = _a.yAxis;\n\n    if (!xKey || !yKey) {\n      return '';\n    }\n\n    var _b = this,\n        tooltip = _b.tooltip,\n        xName = _b.xName,\n        yName = _b.yName,\n        sizeKey = _b.sizeKey,\n        sizeName = _b.sizeName,\n        labelKey = _b.labelKey,\n        labelName = _b.labelName;\n\n    var tooltipRenderer = tooltip.renderer;\n    var color = this.marker.fill || this.fill || 'gray';\n    var title = this.title || yName;\n    var datum = nodeDatum.seriesDatum;\n    var xValue = datum[xKey];\n    var yValue = datum[yKey];\n    var xString = sanitizeHtml(xAxis.formatDatum(xValue));\n    var yString = sanitizeHtml(yAxis.formatDatum(yValue));\n    var content = \"<b>\" + sanitizeHtml(xName || xKey) + \"</b>: \" + xString + (\"<br><b>\" + sanitizeHtml(yName || yKey) + \"</b>: \" + yString);\n\n    if (sizeKey) {\n      content += \"<br><b>\" + sanitizeHtml(sizeName || sizeKey) + \"</b>: \" + sanitizeHtml(datum[sizeKey]);\n    }\n\n    if (labelKey) {\n      content = \"<b>\" + sanitizeHtml(labelName || labelKey) + \"</b>: \" + sanitizeHtml(datum[labelKey]) + \"<br>\" + content;\n    }\n\n    var defaults = {\n      title: title,\n      backgroundColor: color,\n      content: content\n    };\n\n    if (tooltipRenderer) {\n      return toTooltipHtml(tooltipRenderer({\n        datum: datum,\n        xKey: xKey,\n        xValue: xValue,\n        xName: xName,\n        yKey: yKey,\n        yValue: yValue,\n        yName: yName,\n        sizeKey: sizeKey,\n        sizeName: sizeName,\n        labelKey: labelKey,\n        labelName: labelName,\n        title: title,\n        color: color\n      }), defaults);\n    }\n\n    return toTooltipHtml(defaults);\n  };\n\n  ScatterSeries.prototype.listSeriesItems = function (legendData) {\n    var _a = this,\n        id = _a.id,\n        data = _a.data,\n        xKey = _a.xKey,\n        yKey = _a.yKey,\n        yName = _a.yName,\n        title = _a.title,\n        visible = _a.visible,\n        marker = _a.marker,\n        fill = _a.fill,\n        stroke = _a.stroke,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity;\n\n    if (data && data.length && xKey && yKey) {\n      legendData.push({\n        id: id,\n        itemId: undefined,\n        enabled: visible,\n        label: {\n          text: title || yName || yKey\n        },\n        marker: {\n          shape: marker.shape,\n          fill: marker.fill || fill || 'rgba(0, 0, 0, 0)',\n          stroke: marker.stroke || stroke || 'rgba(0, 0, 0, 0)',\n          fillOpacity: fillOpacity,\n          strokeOpacity: strokeOpacity\n        }\n      });\n    }\n  };\n\n  ScatterSeries.className = 'ScatterSeries';\n  ScatterSeries.type = 'scatter';\n\n  __decorate([reactive('layoutChange')], ScatterSeries.prototype, \"title\", void 0);\n\n  __decorate([reactive('dataChange')], ScatterSeries.prototype, \"xKey\", void 0);\n\n  __decorate([reactive('dataChange')], ScatterSeries.prototype, \"yKey\", void 0);\n\n  __decorate([reactive('dataChange')], ScatterSeries.prototype, \"sizeKey\", void 0);\n\n  __decorate([reactive('dataChange')], ScatterSeries.prototype, \"labelKey\", void 0);\n\n  return ScatterSeries;\n}(CartesianSeries);\n\nexport { ScatterSeries };","map":{"version":3,"sources":["/Users/julianneagresta/Projects/openlibrary-search-histogram/node_modules/ag-charts-community/dist/es6/chart/series/cartesian/scatterSeries.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Selection","SeriesTooltip","finiteExtent","LinearScale","reactive","CartesianSeries","CartesianSeriesMarker","ChartAxisDirection","getMarker","toTooltipHtml","ContinuousScale","sanitizeHtml","Label","Text","HdpiCanvas","ScatterSeriesTooltip","_super","ScatterSeries","_this","xDomain","yDomain","xData","yData","sizeData","sizeScale","nodeData","markerSelection","select","pickGroup","selectAll","labelData","labelSelection","group","marker","label","_fill","_stroke","_strokeWidth","_fillOpacity","_strokeOpacity","xKey","yKey","xName","yName","sizeName","labelName","tooltip","_a","addPropertyListener","onMarkerShapeChange","addEventListener","update","enabled","scheduleData","get","set","value","enumerable","configurable","scheduleLayout","onHighlightChange","updateMarkerNodes","setData","exit","remove","fireEvent","type","setColors","fills","strokes","fill","stroke","processData","sizeKey","labelKey","xAxis","yAxis","data","map","font","getFont","text","String","size","getTextSize","domain","scale","fixNumericExtent","getDomain","direction","X","getNodeData","getLabelData","fireNodeClickEvent","event","datum","series","seriesDatum","generateNodeData","xScale","yScale","isContinuousX","isContinuousY","xOffset","bandwidth","yOffset","_b","range","maxSize","xDatum","yDatum","noDatum","isNaN","isFinite","x","convert","y","inRange","push","point","visible","chart","layoutPending","dataPending","updateMarkerSelection","updateLabelSelection","updateLabelNodes","placedLabels","placeLabels","updateLabels","enterLabels","enter","append","merge","MarkerShape","shape","updateMarkers","enterMarkers","each","color","fontStyle","fontWeight","fontSize","fontFamily","textAlign","textBaseline","highlightedDatum","strokeWidth","fillOpacity","strokeOpacity","highlightStyle","highlightFill","highlightStroke","markerStrokeWidth","undefined","markerFormatter","formatter","node","highlighted","markerFill","markerStroke","markerFormat","translationX","translationY","getTooltipHtml","nodeDatum","tooltipRenderer","renderer","title","xValue","yValue","xString","formatDatum","yString","content","defaults","backgroundColor","listSeriesItems","legendData","id","itemId","className"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Selection } from \"../../../scene/selection\";\nimport { SeriesTooltip } from \"../series\";\nimport { finiteExtent } from \"../../../util/array\";\nimport { LinearScale } from \"../../../scale/linearScale\";\nimport { reactive } from \"../../../util/observable\";\nimport { CartesianSeries, CartesianSeriesMarker } from \"./cartesianSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { getMarker } from \"../../marker/util\";\nimport { toTooltipHtml } from \"../../chart\";\nimport ContinuousScale from \"../../../scale/continuousScale\";\nimport { sanitizeHtml } from \"../../../util/sanitize\";\nimport { Label } from \"../../label\";\nimport { Text } from \"../../../scene/shape/text\";\nimport { HdpiCanvas } from \"../../../canvas/hdpiCanvas\";\nvar ScatterSeriesTooltip = /** @class */ (function (_super) {\n    __extends(ScatterSeriesTooltip, _super);\n    function ScatterSeriesTooltip() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        reactive('change')\n    ], ScatterSeriesTooltip.prototype, \"renderer\", void 0);\n    return ScatterSeriesTooltip;\n}(SeriesTooltip));\nexport { ScatterSeriesTooltip };\nvar ScatterSeries = /** @class */ (function (_super) {\n    __extends(ScatterSeries, _super);\n    function ScatterSeries() {\n        var _this = _super.call(this) || this;\n        _this.xDomain = [];\n        _this.yDomain = [];\n        _this.xData = [];\n        _this.yData = [];\n        _this.sizeData = [];\n        _this.sizeScale = new LinearScale();\n        _this.nodeData = [];\n        _this.markerSelection = Selection.select(_this.pickGroup).selectAll();\n        _this.labelData = [];\n        _this.labelSelection = Selection.select(_this.group).selectAll();\n        _this.marker = new CartesianSeriesMarker();\n        _this.label = new Label();\n        _this._fill = '#c16068';\n        _this._stroke = '#874349';\n        _this._strokeWidth = 2;\n        _this._fillOpacity = 1;\n        _this._strokeOpacity = 1;\n        _this.xKey = '';\n        _this.yKey = '';\n        _this.xName = '';\n        _this.yName = '';\n        _this.sizeName = 'Size';\n        _this.labelName = 'Label';\n        _this.tooltip = new ScatterSeriesTooltip();\n        var _a = _this, marker = _a.marker, label = _a.label;\n        marker.addPropertyListener('shape', _this.onMarkerShapeChange, _this);\n        marker.addEventListener('change', _this.update, _this);\n        _this.addPropertyListener('xKey', function () { return _this.xData = []; });\n        _this.addPropertyListener('yKey', function () { return _this.yData = []; });\n        _this.addPropertyListener('sizeKey', function () { return _this.sizeData = []; });\n        label.enabled = false;\n        label.addEventListener('change', _this.update, _this);\n        label.addEventListener('dataChange', _this.scheduleData, _this);\n        label.addPropertyListener('fontSize', _this.scheduleData, _this);\n        return _this;\n    }\n    Object.defineProperty(ScatterSeries.prototype, \"fill\", {\n        get: function () {\n            return this._fill;\n        },\n        set: function (value) {\n            if (this._fill !== value) {\n                this._fill = value;\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ScatterSeries.prototype, \"stroke\", {\n        get: function () {\n            return this._stroke;\n        },\n        set: function (value) {\n            if (this._stroke !== value) {\n                this._stroke = value;\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ScatterSeries.prototype, \"strokeWidth\", {\n        get: function () {\n            return this._strokeWidth;\n        },\n        set: function (value) {\n            if (this._strokeWidth !== value) {\n                this._strokeWidth = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ScatterSeries.prototype, \"fillOpacity\", {\n        get: function () {\n            return this._fillOpacity;\n        },\n        set: function (value) {\n            if (this._fillOpacity !== value) {\n                this._fillOpacity = value;\n                this.scheduleLayout();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ScatterSeries.prototype, \"strokeOpacity\", {\n        get: function () {\n            return this._strokeOpacity;\n        },\n        set: function (value) {\n            if (this._strokeOpacity !== value) {\n                this._strokeOpacity = value;\n                this.scheduleLayout();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ScatterSeries.prototype.onHighlightChange = function () {\n        this.updateMarkerNodes();\n    };\n    ScatterSeries.prototype.onMarkerShapeChange = function () {\n        this.markerSelection = this.markerSelection.setData([]);\n        this.markerSelection.exit.remove();\n        this.update();\n        this.fireEvent({ type: 'legendChange' });\n    };\n    ScatterSeries.prototype.setColors = function (fills, strokes) {\n        this.fill = fills[0];\n        this.stroke = strokes[0];\n        this.marker.fill = fills[0];\n        this.marker.stroke = strokes[0];\n    };\n    ScatterSeries.prototype.processData = function () {\n        var _a = this, xKey = _a.xKey, yKey = _a.yKey, sizeKey = _a.sizeKey, labelKey = _a.labelKey, xAxis = _a.xAxis, yAxis = _a.yAxis, marker = _a.marker, label = _a.label;\n        var data = xKey && yKey && this.data ? this.data : [];\n        this.xData = data.map(function (d) { return d[xKey]; });\n        this.yData = data.map(function (d) { return d[yKey]; });\n        this.sizeData = sizeKey ? data.map(function (d) { return d[sizeKey]; }) : [];\n        var font = label.getFont();\n        this.labelData = labelKey ? data.map(function (d) {\n            var text = String(d[labelKey]);\n            var size = HdpiCanvas.getTextSize(text, font);\n            return __assign({ text: text }, size);\n        }) : [];\n        this.sizeScale.domain = marker.domain ? marker.domain : finiteExtent(this.sizeData) || [1, 1];\n        if (xAxis.scale instanceof ContinuousScale) {\n            this.xDomain = this.fixNumericExtent(finiteExtent(this.xData), 'x');\n        }\n        else {\n            this.xDomain = this.xData;\n        }\n        if (yAxis.scale instanceof ContinuousScale) {\n            this.yDomain = this.fixNumericExtent(finiteExtent(this.yData), 'y');\n        }\n        else {\n            this.yDomain = this.yData;\n        }\n        return true;\n    };\n    ScatterSeries.prototype.getDomain = function (direction) {\n        if (direction === ChartAxisDirection.X) {\n            return this.xDomain;\n        }\n        else {\n            return this.yDomain;\n        }\n    };\n    ScatterSeries.prototype.getNodeData = function () {\n        return this.nodeData;\n    };\n    ScatterSeries.prototype.getLabelData = function () {\n        return this.nodeData;\n    };\n    ScatterSeries.prototype.fireNodeClickEvent = function (event, datum) {\n        this.fireEvent({\n            type: 'nodeClick',\n            event: event,\n            series: this,\n            datum: datum.seriesDatum,\n            xKey: this.xKey,\n            yKey: this.yKey,\n            sizeKey: this.sizeKey\n        });\n    };\n    ScatterSeries.prototype.generateNodeData = function () {\n        if (!this.data) {\n            return [];\n        }\n        var _a = this, xAxis = _a.xAxis, yAxis = _a.yAxis;\n        var xScale = xAxis.scale;\n        var yScale = yAxis.scale;\n        var isContinuousX = xScale instanceof ContinuousScale;\n        var isContinuousY = yScale instanceof ContinuousScale;\n        var xOffset = (xScale.bandwidth || 0) / 2;\n        var yOffset = (yScale.bandwidth || 0) / 2;\n        var _b = this, data = _b.data, xData = _b.xData, yData = _b.yData, sizeData = _b.sizeData, sizeScale = _b.sizeScale, marker = _b.marker;\n        var nodeData = [];\n        sizeScale.range = [marker.size, marker.maxSize];\n        for (var i = 0; i < xData.length; i++) {\n            var xDatum = xData[i];\n            var yDatum = yData[i];\n            var noDatum = yDatum == null || (isContinuousY && (isNaN(yDatum) || !isFinite(yDatum))) ||\n                xDatum == null || (isContinuousX && (isNaN(xDatum) || !isFinite(xDatum)));\n            if (noDatum) {\n                continue;\n            }\n            var x = xScale.convert(xDatum) + xOffset;\n            var y = yScale.convert(yDatum) + yOffset;\n            if (!(xAxis.inRange(x) && yAxis.inRange(y))) {\n                continue;\n            }\n            nodeData.push({\n                series: this,\n                seriesDatum: data[i],\n                point: { x: x, y: y },\n                size: sizeData.length ? sizeScale.convert(sizeData[i]) : marker.size,\n                label: this.labelData[i]\n            });\n        }\n        return this.nodeData = nodeData;\n    };\n    ScatterSeries.prototype.update = function () {\n        var _a = this, visible = _a.visible, chart = _a.chart, xAxis = _a.xAxis, yAxis = _a.yAxis;\n        this.group.visible = visible;\n        if (!visible || !chart || chart.layoutPending || chart.dataPending || !xAxis || !yAxis) {\n            return;\n        }\n        this.generateNodeData();\n        this.updateMarkerSelection(this.nodeData);\n        this.updateLabelSelection(this.nodeData);\n        this.updateMarkerNodes();\n        this.updateLabelNodes();\n    };\n    ScatterSeries.prototype.updateLabelSelection = function (nodeData) {\n        var placedLabels = this.chart && this.chart.placeLabels().get(this) || [];\n        var updateLabels = this.labelSelection.setData(placedLabels);\n        updateLabels.exit.remove();\n        var enterLabels = updateLabels.enter.append(Text);\n        this.labelSelection = updateLabels.merge(enterLabels);\n    };\n    ScatterSeries.prototype.updateMarkerSelection = function (nodeData) {\n        var MarkerShape = getMarker(this.marker.shape);\n        var updateMarkers = this.markerSelection.setData(nodeData);\n        updateMarkers.exit.remove();\n        var enterMarkers = updateMarkers.enter.append(MarkerShape);\n        this.markerSelection = updateMarkers.merge(enterMarkers);\n    };\n    ScatterSeries.prototype.updateLabelNodes = function () {\n        var label = this.label;\n        this.labelSelection.each(function (text, datum) {\n            text.text = datum.text;\n            text.fill = label.color;\n            text.x = datum.x;\n            text.y = datum.y;\n            text.fontStyle = label.fontStyle;\n            text.fontWeight = label.fontWeight;\n            text.fontSize = label.fontSize;\n            text.fontFamily = label.fontFamily;\n            text.textAlign = 'left';\n            text.textBaseline = 'top';\n        });\n    };\n    ScatterSeries.prototype.updateMarkerNodes = function () {\n        if (!this.chart) {\n            return;\n        }\n        var highlightedDatum = this.chart.highlightedDatum;\n        var _a = this, marker = _a.marker, xKey = _a.xKey, yKey = _a.yKey, fill = _a.fill, stroke = _a.stroke, strokeWidth = _a.strokeWidth, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity;\n        var _b = this.highlightStyle, highlightFill = _b.fill, highlightStroke = _b.stroke;\n        var markerStrokeWidth = marker.strokeWidth !== undefined ? marker.strokeWidth : strokeWidth;\n        var markerFormatter = marker.formatter;\n        this.markerSelection.each(function (node, datum) {\n            var highlighted = datum === highlightedDatum;\n            var markerFill = highlighted && highlightFill !== undefined ? highlightFill : marker.fill || fill;\n            var markerStroke = highlighted && highlightStroke !== undefined ? highlightStroke : marker.stroke || stroke;\n            var markerFormat = undefined;\n            if (markerFormatter) {\n                markerFormat = markerFormatter({\n                    datum: datum.seriesDatum,\n                    xKey: xKey,\n                    yKey: yKey,\n                    fill: markerFill,\n                    stroke: markerStroke,\n                    strokeWidth: markerStrokeWidth,\n                    size: datum.size,\n                    highlighted: highlighted\n                });\n            }\n            node.fill = markerFormat && markerFormat.fill || markerFill;\n            node.stroke = markerFormat && markerFormat.stroke || markerStroke;\n            node.strokeWidth = markerFormat && markerFormat.strokeWidth !== undefined\n                ? markerFormat.strokeWidth\n                : markerStrokeWidth;\n            node.size = markerFormat && markerFormat.size !== undefined\n                ? markerFormat.size\n                : datum.size;\n            node.fillOpacity = fillOpacity;\n            node.strokeOpacity = strokeOpacity;\n            node.translationX = datum.point.x;\n            node.translationY = datum.point.y;\n            node.visible = marker.enabled && node.size > 0;\n        });\n    };\n    ScatterSeries.prototype.getTooltipHtml = function (nodeDatum) {\n        var _a = this, xKey = _a.xKey, yKey = _a.yKey, xAxis = _a.xAxis, yAxis = _a.yAxis;\n        if (!xKey || !yKey) {\n            return '';\n        }\n        var _b = this, tooltip = _b.tooltip, xName = _b.xName, yName = _b.yName, sizeKey = _b.sizeKey, sizeName = _b.sizeName, labelKey = _b.labelKey, labelName = _b.labelName;\n        var tooltipRenderer = tooltip.renderer;\n        var color = this.marker.fill || this.fill || 'gray';\n        var title = this.title || yName;\n        var datum = nodeDatum.seriesDatum;\n        var xValue = datum[xKey];\n        var yValue = datum[yKey];\n        var xString = sanitizeHtml(xAxis.formatDatum(xValue));\n        var yString = sanitizeHtml(yAxis.formatDatum(yValue));\n        var content = \"<b>\" + sanitizeHtml(xName || xKey) + \"</b>: \" + xString\n            + (\"<br><b>\" + sanitizeHtml(yName || yKey) + \"</b>: \" + yString);\n        if (sizeKey) {\n            content += \"<br><b>\" + sanitizeHtml(sizeName || sizeKey) + \"</b>: \" + sanitizeHtml(datum[sizeKey]);\n        }\n        if (labelKey) {\n            content = \"<b>\" + sanitizeHtml(labelName || labelKey) + \"</b>: \" + sanitizeHtml(datum[labelKey]) + \"<br>\" + content;\n        }\n        var defaults = {\n            title: title,\n            backgroundColor: color,\n            content: content\n        };\n        if (tooltipRenderer) {\n            return toTooltipHtml(tooltipRenderer({\n                datum: datum,\n                xKey: xKey,\n                xValue: xValue,\n                xName: xName,\n                yKey: yKey,\n                yValue: yValue,\n                yName: yName,\n                sizeKey: sizeKey,\n                sizeName: sizeName,\n                labelKey: labelKey,\n                labelName: labelName,\n                title: title,\n                color: color\n            }), defaults);\n        }\n        return toTooltipHtml(defaults);\n    };\n    ScatterSeries.prototype.listSeriesItems = function (legendData) {\n        var _a = this, id = _a.id, data = _a.data, xKey = _a.xKey, yKey = _a.yKey, yName = _a.yName, title = _a.title, visible = _a.visible, marker = _a.marker, fill = _a.fill, stroke = _a.stroke, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity;\n        if (data && data.length && xKey && yKey) {\n            legendData.push({\n                id: id,\n                itemId: undefined,\n                enabled: visible,\n                label: {\n                    text: title || yName || yKey\n                },\n                marker: {\n                    shape: marker.shape,\n                    fill: marker.fill || fill || 'rgba(0, 0, 0, 0)',\n                    stroke: marker.stroke || stroke || 'rgba(0, 0, 0, 0)',\n                    fillOpacity: fillOpacity,\n                    strokeOpacity: strokeOpacity\n                }\n            });\n        }\n    };\n    ScatterSeries.className = 'ScatterSeries';\n    ScatterSeries.type = 'scatter';\n    __decorate([\n        reactive('layoutChange')\n    ], ScatterSeries.prototype, \"title\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], ScatterSeries.prototype, \"xKey\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], ScatterSeries.prototype, \"yKey\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], ScatterSeries.prototype, \"sizeKey\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], ScatterSeries.prototype, \"labelKey\", void 0);\n    return ScatterSeries;\n}(CartesianSeries));\nexport { ScatterSeries };\n"]},"metadata":{},"sourceType":"module"}